<!-- HEADER -->

<app-header></app-header>

<!-- HEADER -->


<!-- SIDE-NAV-ENDS -->

<!-- MAIN-CONTENTS  -->
<div class="row main_count_header">
  <div class="col-6 pt-2">
    <!-- //admin  -->
    <p *ngIf="isAssignedLeads && (leadstatusVisits == '' || leadstatusVisits == null)"
      style="font-weight: 400;font-size: 16px;padding-left: 1.8rem;">Total Leads -
      {{Totalleadcounts}}
      <!-- <span *ngIf="roleid == '1'"> (Unique - {{unquieleadcounts}})</span> -->
    </p>
    <!-- ///executive  -->
    <p *ngIf="!isAssignedLeads" style="font-weight: 400;font-size: 16px;padding-left: 1.8rem;"><span
        *ngIf="roleid == '1'"></span> Assigned Unique Leads - <span>{{reassignleadsCount}}</span></p>
    <!-- <p *ngIf="myOverdues == true && roleid != 1" style="font-weight: 400;font-size: 16px;padding-left: 1.8rem;">Overdues -
        {{overduecounts}}</p> -->
    <!-- //admin && executive  -->
    <p *ngIf="isAssignedLeads && leadstatusVisits == 1" style="font-weight: 400;font-size: 16px;padding-left: 1.8rem;">
      Direct Leads -
      {{Totalleadcounts}}<span> (Unquie - {{unquieleadcounts}})</span></p>
    <p *ngIf="isAssignedLeads && leadstatusVisits == 2" style="font-weight: 400;font-size: 16px;padding-left: 1.8rem;">
      Assigned Leads -
      {{Totalleadcounts}}<span> (Unquie - {{unquieleadcounts}})</span></p>
  </div>

  <div class="col-6 text-right" *ngIf="isAssignedLeads">
    <button class="btn btn-warning" type="button" (click)="downloadDocument()"
      *ngIf="roleid == 1 && pendingleadsparam != 1"><i class="fa fa-download"></i> Download</button>
    <button type="button" class="btn btn-warning" (click)="onclickReAssign()" data-toggle="modal"
      data-target="#assign_lead" *ngIf="roleid == '1'"><i class="fas fa-share"></i> Re-Assign</button>
    <!-- <button *ngIf="roleid == 1" type="button" class="btn btn-warning" (click)="morefilter()"><i class="fas fa-filter"
        aria-hidden="true"></i> More Filter</button> -->
    <button type="button" class="btn btn-warning" (click)="refresh()"><i class="fas fa-redo"></i>Reset</button>
  </div>

  <div class="col-6 text-right" *ngIf="isReAssign">
    <button type="button" class="btn btn-warning" (click)="backToDetails()"><i class="fas fa-times"
        style="color: rgb(216, 130, 130);"></i>Cancel</button>
    <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#assign_lead"
      (click)="filterselectedLeads()"><i class="fas fa-share"></i> Assign Now</button>
  </div>
</div>

<div *ngIf=filterLoader class="main-lds-ring-div">
  <div class="lds-ring">
    <div></div>
    <div></div>
    <div></div>
    <div></div>
  </div>
</div>

<div class="body-cntnts dimmable blurring">
  <div class="enquiry_content_main">
    <!-- this is the table for assigned leads -->
    <div class="table-container " [hidden]="!isAssignedLeads">
      <div class="button_section">
        <span class="align-items-center cursor-pointer chevleft" (click)="moveToLeft()"><i class="fas fa-chevron-left"
            style="font-size: 1.2rem;color: #999;"></i></span>
        <div class="leadassign" #leadassign>
          <!-- *****************************Page Three Navigations***************************** -->
          <a class="add_class pending_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': leadstatusVisits == '1' || visitedDatefilterview == true || additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'}"
            [queryParams]="{pending: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Untouched
            <span>({{pendingleadcounts}})</span>
          </a>

          <a class="add_class followups_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': leadstatusVisits == '1' || visitedDatefilterview == true || additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'}"
            [queryParams]="{followups: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            General Followups
            <span>({{followupleadcounts}})</span>
          </a>

          <a class="add_class nc_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': visitedDatefilterview == true || additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'}"
            [queryParams]="{nc: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            NC
            <span>({{normalcallcounts}})</span>
          </a>

          <a class="add_class usv_section other_section" routerLink="/mandate-assigned-leads"
            [queryParams]="{usv: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            USV
            <span>({{usvCounts}})</span>
          </a>

          <a class="add_class rsv_section other_section" routerLink="/mandate-assigned-leads"
            [queryParams]="{rsv: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            RSV
            <span>({{rsvCounts}})</span>
          </a>

          <a class="add_class fn_section other_section" routerLink="/mandate-assigned-leads"
            [queryParams]="{fn: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            FN
            <span>({{fnCounts}})</span>
          </a>

          <a class="add_class inactive_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': visitedDatefilterview == true || additionalParam == 'AllVisits'}"
            [queryParams]="{inactive: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Inactive
            <span>({{inactivecounts}})</span>
          </a>

          <a class="add_class junkleads_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': visitedDatefilterview == true || additionalParam == 'AllVisits'}"
            [queryParams]="{junkleads: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Junk Leads
            <span>({{junkleadsCounts}})</span>
          </a>

          <a class="add_class junkvisits_section other_section" routerLink="/mandate-assigned-leads"
            [queryParams]="{junkvisits: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Junk Visits
            <span>({{junkvisitsCounts}})</span>
          </a>

          <a class="add_class booking_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': visitedDatefilterview == true}"
            [queryParams]="{bookingRequest: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Booking Requests
            <span>({{bookingRequestCounts}})</span>
          </a>

          <a class="add_class booked_section other_section" routerLink="/mandate-assigned-leads"
            [ngClass]="{'blurred': visitedDatefilterview == true}"
            [queryParams]="{booked: 1,from:fromdate, to:todate, property:propertyid, propname:propertyname, execid:execid, execname:execname, stage:stagevalue, stagestatus:stagestatusval,team:team,visits:leadstatusVisits,source:source,receivedFrom:receivedFromDate,receivedTo:receivedToDate,visitedfrom:visitedFrom,visitedto:visitedTo,htype:'mandate'}">
            Booked
            <span>({{bookedCounts}})</span>
          </a>


          <!-- *****************************Page Three Navigations***************************** -->
        </div>
        <span class="align-items-center cursor-pointer chevright" (click)="moveToRight()"><i
            class="fas fa-chevron-right" style="font-size: 1.2rem;color: #999;"></i></span>
      </div>

      <!-- ----------------------------to show Table filter data---------------------------- -->
      <div id="filtermaindiv" class="filterspan ml-2">
        <span *ngIf="propertyfilterview && propertyid != ''">
          <div class="p-2 chip">
            {{propertyname}}
            <span class="closebtn" (click)="propertyclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="sourceFilter && source != ''">
          <div class="p-2 chip">
            {{source == 'GR - Microsite' ? 'GR - campaign' : source}}
            <span class="closebtn" (click)="sourceClose()">&times;</span>
          </div>
        </span>
        <span *ngIf="executivefilterview && execid != ''">
          <div class="p-2 chip">
            {{execname}}
            <span class="closebtn" (click)="executiveclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="priorityFilter">
          <div class="p-2 chip">
            {{priorityName}}
            <span class="closebtn" (click)="priorityClose()">&times;</span>
          </div>
        </span>
        <span
          *ngIf="stagefilterview && (usvParam || pendingleadsparam || followupleadsparam || bookingRequestParam || bookedParam || inactiveparam) != 1">
          <div class="p-2 chip">
            {{stagevalue}}
            <span *ngIf="stagestatusfilterview">{{stagestatusvaltext}}</span>
            <span class="closebtn" (click)="stageclose()">&times;</span>
          </div>
        </span>
        <!-- <span *ngIf="donestatusfilterview && (usvParam || pendingleadsparam || followupleadsparam || bookingRequestParam || bookedParam || inactiveparam) != 1">
          <div class="p-2 chip">
           {{donestagestatusvaltext}}
            <span class="closebtn" (click)="stageclose()">&times;</span>
          </div>
        </span> -->
        <span *ngIf="categeoryfilterview && categoryStageName != '' && categoryStage != ''">
          <div class="p-2 chip" *ngIf="categeoryfilterview && categoryStageName != '' && categoryStage != ''">
            {{categoryStageName}}
            <span class="closebtn" (click)="stageclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="datefilterview && fromdate && todate">
          <div class="p-2 chip">
            Next Action: {{fromdate | date:'dd-MMM-yyyy'}} - {{todate | date:'dd-MMM-yyyy'}}
            <span class="closebtn" (click)="dateclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="receivedDatefilterview && receivedFromDate && receivedToDate">
          <div class="p-2 chip">
            Received On: {{receivedFromDate | date:'dd-MMM-yyyy'}} - {{receivedToDate | date:'dd-MMM-yyyy'}}
            <span class="closebtn" (click)="receivedDateclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="visitedDatefilterview ">
          <div class="p-2 chip">
            Visited On: {{visitedFrom | date:'dd-MMM-yyyy'}} - {{visitedTo | date:'dd-MMM-yyyy'}}
            <span class="closebtn" (click)="visitedDateclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="assignedOnDatefilterview && assignedFrom && assignedTo">
          <div class="p-2 chip">
            Assigned On: {{assignedFrom | date:'dd-MMM-yyyy'}} - {{assignedTo | date:'dd-MMM-yyyy'}}
            <span class="closebtn" (click)="assignedOnDateclose()">&times;</span>
          </div>
        </span>
        <span *ngIf="isAdditonalParamPresent">
          <div class="p-2 chip">
            {{additionalParam }} ({{additionalParamCount}})
            <span class="closebtn" (click)="removeAdditionalParam()">&times;</span>
          </div>
        </span>

        <span *ngIf="selectedLeadStatus && selectedLeadStatus != 'All'">
          <div class="p-2 chip">
            Visit Type : {{selectedLeadStatus}}
            <span class="closebtn" (click)="removeselectedLeadStatus()">&times;</span>
          </div>
        </span>

        <span *ngIf="selectedBookingLeadStatus && selectedBookingLeadStatus != 'All'">
          <div class="p-2 chip">
            {{selectedBookingLeadStatus}}
            <span class="closebtn" (click)="removeselectedLeadStatus()">&times;</span>
          </div>
        </span>
      </div>

      <div class="CSassigned_table" #scrollContainer>
        <div class="crm-sub-container padding-medium-full">
          <div class="panel-1 crm-auto-scrollrm panel-content">
            <!-- All Visits Related Data listing table For Executive View-->
            <table *ngIf="assignedleadstable" class="content_table_main table table-striped table-bordered"
              infinite-scroll [fromRoot]="true" [scrollWindow]="false" [infiniteScrollDistance]="2"
              [infiniteScrollThrottle]="50" (scrolled)="loadMoreassignedleads()"
              [infiniteScrollContainer]="'.CSassigned_table'">
              <thead>
                <tr class="header">
                  <!-- ----------------------------Sl.no---------------------------- -->
                  <th>#</th>
                  <!-- ----------------------------Name---------------------------- -->
                  <th>Name </th>
                  <!-- ----------------------------Number---------------------------- -->
                  <th>Number</th>
                  <!-- ----------------------------lead status with filter---------------------------- -->
                  <th *ngIf="pendingleadsparam != 1 && followupleadsparam != 1 && normalcallparam != 1"
                    style="width: 220px;">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Visit Type</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="assignLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="assignLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('All')">All</a>
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('Assigned')">Assigned</a>
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('Direct Visits')">Direct
                              Visits</a>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------property with filter---------------------------- -->
                  <th>
                    <div class="d-flex justify-content-between">
                      <span>Property</span>
                      <div>
                        <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu" aria-labelledby="bookingLeadDropdown"
                          style="cursor:pointer; max-width: 250px ;max-height: 250px; overflow-y: auto;">
                          <!-- Filter Search  input -->
                          <div class="dropdown-search-container"><input type="text" class="form-control propsearch"
                              placeholder="Search..." [(ngModel)]="searchTerm" (input)="filterProjects()"
                              style="margin-bottom: 2px;"></div>
                          <!-- Dropdown items with checkboxes -->
                          <div *ngFor="let project of mandateprojects">
                            <label class="dropdown-item dropDownCursor">
                              <!-- <input type="checkbox" class="mr-2 loopcheckbox hidepropcheckbox" id="hidepropcheckboxid"
                                value="{{project?.property_idfk}}" name='propFilter' (change)="onCheckboxChange()"> -->
                              <span (click)="onCheckboxChange(project)">{{ project.property_info_name }}</span>
                            </label>
                          </div>
                        </div>
                      </div>
                    </div>
                  </th>
                  <!-- ----------------------------stage with filter---------------------------- -->
                  <th *ngIf="!(pendingleadsparam) == '1'">
                    <span
                      *ngIf="((bookedParam || normalcallparam || usvParam || junkleadsParam || additionalParam == 'Active' || additionalParam == 'Touched')== '1')&& (rsvParam || fnParam || followupleadsparam || bookingRequestParam || junkvisitsParam) != 1">Stage</span>
                    <div class="d-flex justify-content-between align-items-center" *ngIf=" (rsvParam || fnParam) == 1">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"
                              *ngIf="((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('1')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">Fixed</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('2')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">ReFixed</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('3')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">Done</a>
                            <!-- <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('4')"
                              *ngIf="(stagestatusval == 3 || usvParam == 1)">Followup</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('5')"
                              *ngIf="(stagestatusval == 3 || usvParam == 1)">Junk</a> -->
                          </div>
                        </div>
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center"
                      *ngIf="(junkvisitsParam == 1 || (additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'ActiveVisits'))&& (usvParam || rsvParam ||fnParam || followupleadsparam || inactiveparam || bookingRequestParam || bookedParam || junkleadsParam) != 1">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu" aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <!-- <div class="dropdown-item dropDownCursor " (click)="junkstatuschange('Fresh','')">Fresh
                            </div> -->
                            <div class="dropdown-item dropDownCursor">
                              <div class="d-flex justify-content-between" (click)="junkstatuschange('USV','')">
                                <span>USV</span><i class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','1')">Fix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','2')">Refix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','3')">Done</a>
                              </div>
                            </div>
                            <div class="dropdown-item dropDownCursor">
                              <div class="d-flex justify-content-between" (click)="junkstatuschange('RSV','')">
                                <span>RSV</span><i class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','1')">Fix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','2')">Refix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','3')">Done</a>
                              </div>
                            </div>
                            <div class="dropdown-item dropDownCursor">
                              <div class="d-flex justify-content-between"
                                (click)="junkstatuschange('Final Negotiation','')"><span>FN</span><i
                                  class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('Final Negotiation','1')">Fix</a>
                                <a class="submenu-item"
                                  (click)="junkStageStatusChange('Final Negotiation','2')">Refix</a>
                                <a class="submenu-item"
                                  (click)="junkStageStatusChange('Final Negotiation','3')">Done</a>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <!-- <div>
                        <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('USV')">USV</a>
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('RSV')">RSV</a>
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('Final Negotiation')">FN</a>
                        </div>
                      </div> -->
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center" *ngIf="bookingRequestParam == 1 ">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('All')">All</a>
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('Rejected')">Rejected</a>
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('Pending')">Pending</a>
                          </div>
                        </div>
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center"
                      *ngIf=" (followupleadsparam || inactiveparam) == 1 ">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu categoryBasedFilter" aria-labelledby="category  Dropdown"
                            style="cursor:pointer; max-height: 250px;max-width: 250px;overflow-y: auto;">
                            <!-- Filter Search  input -->
                            <div class="dropdown-search-container"><input type="text"
                                class="form-control categorysearch" placeholder="Search..."
                                [(ngModel)]="searchTerm_stagecategory" (input)="filterStageCategory()"
                                style="margin-bottom: 2px;"></div>
                            <!-- Dropdown items with checkboxes -->
                            <div *ngIf="followctgFilter?.length">
                              <div class="exec_list_checkbox">
                                <div *ngFor="let category of followctgFilter">
                                  <label class="dropdown-item dropDownCursor mb-1"
                                    (click)="onCheckboxstageCategoryChange(category)">
                                    <!-- <input type="checkbox" class="mr-2 loopcheckbox hideStageCategorycheckbox" id="hideStageCategorycheckboxid"
                                   value="{{category?.followup_section_IDPK}}" name='categoryStageFilter' (change)="onCheckboxstageCategoryChange()"> -->
                                    {{ category.followup_categories }}
                                  </label>
                                </div>
                              </div>


                            </div>
                            <div *ngIf="!followctgFilter?.length" class="text-center" style="color: #666666;">
                              <h4>No Categories Found</h4>
                            </div>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------Executive filter only for team lead---------------------------- -->
                  <th *ngIf="role_type == '1'">
                    <div class="d-flex justify-content-between">
                      <span>Assignees</span>
                      <div *ngIf="(pendingleadsparam || followupleadsparam || normalcallparam) != '1'">
                        <button class="btn btn-warning" type="button" id="executiveDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu executiveBasedFilter" aria-labelledby="executiveDropdown"
                          style="cursor:pointer; max-height: 250px;max-width: 250px;overflow-y: auto;">
                          <!-- Filter Search  input -->
                          <div class="dropdown-search-container"><input type="text" class="form-control executivesearch"
                              placeholder="Search..." [(ngModel)]="searchTerm_executive" (input)="filterExecutive()"
                              style="margin-bottom: 2px;"></div>
                          <!-- Dropdown items with checkboxes -->
                          <div *ngIf="mandateExecutivesFilter?.length">
                            <div *ngFor="let exec of mandateExecutivesFilter">
                              <label class="dropdown-item dropDownCursor mb-1">
                                <input type="checkbox" class="mr-2 loopcheckbox hideExecutivecheckbox"
                                  id="hideExecutivecheckboxid" value="{{exec?.id}}" name='executiveFilter'
                                  (change)="onCheckboxExecutiveChange()">
                                {{ exec.name }}
                              </label>
                            </div>
                          </div>
                          <div *ngIf="!mandateExecutivesFilter?.length" class="text-center" style="color: #666666;">
                            <h4>No Executives Found</h4>
                          </div>
                        </div>
                      </div>
                    </div>
                  </th>
                  <!-- ----------------------------assigned on---------------------------- -->
                  <th>
                  <div class="d-flex justify-content-between align-items-center">
                    <span>Assigned On</span>
                    <span class="leadstatusdrop d-flex">
                      <div>
                        <button class="btn btn-warning" type="button" id="datefilterDropdown" data-toggle="dropdown"
                          (click)="showdateRange4()" aria-haspopup="true" aria-expanded="false"
                          style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu " aria-labelledby="datefilterDropdown"
                          style="cursor:pointer;padding: 0rem;display: none;">
                          <div style="position: relative;display: none;">
                            <input #datepicker4 class="form-control" id="fromdate" name="options" type="text"
                              bsDaterangepicker autocomplete="off" placeholder="Select Date"
                              [(bsValue)]="assignedOnDateRange"
                              (bsValueChange)="onAssignedOnDateRangeSelected($event)" required>
                            <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                              <i class="fas fa-calendar-alt"></i>
                            </span>
                          </div>
                        </div>
                      </div>
                    </span>
                  </div>
                  </th>
                  <!-- ----------------------------Next followup for general followup---------------------------- -->
                  <th *ngIf="followupleadsparam == '1'">Next Followup</th>
                  <!-- ----------------------------fixed visits---------------------------- -->
                  <!-- <th *ngIf="fixedvisitsparam == '1'">Visits Fixed</th> -->

                  <!-- ----------------------------next action for usv,rsv,fn and nc with from and todate filter---------------------------- -->
                  <th
                    *ngIf="((normalcallparam == 1) || (additionalParam == 'Active' || additionalParam == 'Assigned')) || ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined) && (usvParam ==1 || rsvParam ==1 || fnParam == 1 ))"
                    style="width: 10%;">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Next Action </span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <button class="btn btn-warning" type="button" id="datefilterDropdown" data-toggle="dropdown"
                            (click)="showdateRange2()" aria-haspopup="true" aria-expanded="false"
                            style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="datefilterDropdown"
                            style="cursor:pointer;padding: 0rem;display: none;">
                            <div style="position: relative;display: none;">
                              <input #datepicker2 class="form-control" id="fromdate" name="options" type="text"
                                bsDaterangepicker autocomplete="off" placeholder="Select Date"
                                [(bsValue)]="nextActionDateRange"
                                (bsValueChange)="onNextActionDateRangeSelected($event)" required>
                              <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                                <i class="fas fa-calendar-alt"></i>
                              </span>
                            </div>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------visited for usv,rsv,fn and nc with visited from and visited to filter---------------------------- -->
                  <th
                    *ngIf="(((usvParam || rsvParam || fnParam || junkvisitsParam) == '1') || (additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'  || additionalParam == 'Assigned'))">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Visited On</span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <!-- <div id="reportrange" class="cursor-pointer">
                            <i class="fas fa-filter" style="color: white;"></i>&nbsp; -->
                            <!-- <span></span>  -->
                            <!-- <i class="fa fa-caret-down"></i> -->
                          <!-- </div> -->
                          <button class="btn btn-warning visitedDatefilter" type="button" id="visitedDatefilterDropdown"
                            data-toggle="dropdown" (click)="showdateRange3()" aria-haspopup="true" aria-expanded="false"
                            style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                           <div class="dropdown-menu visitedDfilter" aria-labelledby="visitedDatefilterDropdown"
                            style="cursor:pointer;padding: 0rem;display: none;">
                            <div style="position: relative;display: none;">
                              <input #datepicker3 class="form-control" id="visiteddate" name="options" type="text"
                                bsDaterangepicker autocomplete="off" [maxDate]="currentdateforcompare"
                                placeholder="Select Date" [(bsValue)]="visitedDateRange"
                                (bsValueChange)="onVisitedDateRangeSelected($event)" required>
                              <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                                <i class="fas fa-calendar-alt"></i>
                              </span>
                            </div>
                          </div>
                          
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------overdue---------------------------- -->
                  <!-- <th *ngIf="overduesparam == '1'">Overdued On</th> -->
                  <!-- ----------------------------last update for inactive---------------------------- -->
                  <th *ngIf="inactiveparam == '1'">Last Update</th>
                  <!-- ----------------------------lastest remarks---------------------------- -->
                  <th class="remarksection" *ngIf="!(freshleadsparam == '1' || pendingleadsparam == '1' || leaddetails)"
                    style="width: 20%;">Latest Remarks</th>
                  <th *ngIf="bookingRequestParam == 1 || bookedParam == 1"></th>
                </tr>
              </thead>
              <tbody *ngIf="callerleads?.length" class="enquiry_table_body">
                <tr *ngFor="let leads of callerleads; let i = index">
                  <!-- ----------------------------Sl.no---------------------------- -->
                  <td style="text-align: center;">
                    {{i+1}}</td>
                  <!-- ----------------------------Sl.no---------------------------- -->

                  <!-- ----------------------------Customer Name ---------------------------- -->
                  <td
                    [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                    <span *ngIf="inactiveparam == '1' || junkvisitsParam == '1' || junkleadsParam == '1'">
                      <!-- ----------------------------Customer name and stage (lead pushed junk/inactive above 2 hours not clickable---------------------------- -->
                      <span
                        *ngIf="(inactiveparam == '1' && leads.rnr_counts >= 3) || ((junkvisitsParam == '1' || junkleadsParam == '1') && isOverAnHourOld(leads.lastupdated))">
                        <a>
                          <div class="statuscard anchor disabled"
                            [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                            {{leads.CustomerName}}<span class="statusbatch"
                              *ngIf="(leads.assigneddate | date:'yyyy-MM-dd') == todaysdateforcompare  && pendingleadsparam == '1'">{{leads.Leadphase}}
                              <i class="fa fa-sync-alt"></i> </span></div>
                        </a>
                      </span>
                      <!-- ----------------------------Customer name and stage (lead pushed junk/inactive within 2 hours it's clickable---------------------------- -->
                      <span
                        *ngIf="(inactiveparam == '1' && (leads.rnr_counts < 3 || leads.rnr_counts == null)) || ((junkvisitsParam == '1' || junkleadsParam == '1') && !isOverAnHourOld(leads.lastupdated))">
                        <a class="btn_style cursor-pointer"
                          routerLink="/mandate-customers/{{leads.LeadID}}/{{leads?.ExecId}}/{{'0'}}/{{'mandate'}}/{{leads.propertyid}}">
                          <div class="statuscard"
                            [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                            {{leads.CustomerName}}<span class="statusbatch"
                              *ngIf="(leads.assigneddate | date:'yyyy-MM-dd') == todaysdateforcompare  && pendingleadsparam == '1'">{{leads.Leadphase}}
                              <i class="fa fa-sync-alt"></i> </span></div>
                        </a>
                      </span>
                    </span>

                    <!-- ----------------------------Customer name and stage for all the stages execpt junk and inactive---------------------------- -->
                    <a *ngIf="!inactiveparam == '1' && !junkvisitsParam == '1' && !junkleadsParam == '1'"
                      class="btn_style cursor-pointer"
                      routerLink="/mandate-customers/{{leads?.LeadID}}/{{leads?.ExecId}}/{{'0'}}/{{'mandate'}}/{{leads.propertyid}}"
                      [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                      <div class="statuscard">{{leads?.CustomerName}}
                      </div>
                    </a>
                  </td>
                  <!-- ----------------------------Customer Name ---------------------------- -->

                  <!-- ----------------------------Customer number ---------------------------- -->
                  <td>
                    <span *ngIf="!inactiveparam != '1' || !junkvisitsParam != '1' || !junkleadsParam != 1">
                      <!-- ----------------------------Customer number is hidden in active and junk stage if the pushed time is greater than 2 hours---------------------------- -->
                      <span *ngIf="isOverAnHourOld(leads.lastupdated)">+91xxxxxxxx</span>
                      <!-- ----------------------------Customer number is shown in active and junk stage if the pushed time is within 2 hours---------------------------- -->
                      <span *ngIf="!isOverAnHourOld(leads.lastupdated)">{{leads.number}}</span>
                    </span>
                    <!-- ----------------------------Customer number is shown for all the stages execpt active and junk ---------------------------- -->
                    <span
                      *ngIf="!inactiveparam == '1' && !junkvisitsParam == '1' && !junkleadsParam == '1'">{{leads?.number}}</span>
                  </td>
                  <!-- ----------------------------Customer number ---------------------------- -->

                  <!-- ----------------------------lead Assigned or Direct visit---------------------------- -->
                  <td *ngIf="pendingleadsparam != 1 && followupleadsparam != 1 && normalcallparam != 1">
                    <span *ngIf="leads?.Leadidentifier == 0">Assigned</span>
                    <span *ngIf="leads?.Leadidentifier == 1">Direct</span>
                  </td>
                  <!-- ----------------------------lead Assigned or Direct visit---------------------------- -->

                  <!-- ----------------------------lead Properties---------------------------- -->
                  <td>
                    {{leads.propertyname}}</td>
                  <!-- ----------------------------lead Properties---------------------------- -->

                  <!-- ----------------------------lead stage tester---------------------------- -->
                  <td *ngIf="!(pendingleadsparam == '1')">
                    <!-- ----------------------------lead stage is displayed for the stages not equal to usv,NC and lead phase not equal to junk and Final negotiation and not equal to done stage---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase != 'Final Negotiation' && leads.Leadphase != 'Junk' && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && usvParam != 1 && normalcallparam != 1">{{leads.Leadphase}}<span
                        *ngIf="inactiveparam == '1' || followupleadsparam == '1' && leads.Leadphase == 'Fresh'">
                        - {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------lead stage is displayed for the stages not equal to usv,NC and lead phase not equal to junk and Final negotiation and not equal to done stage---------------------------- -->

                    <!-- ----------------------------lead stage is displayed for the stages  booked,booking request,followup and inactive and done stage---------------------------- -->
                    <span
                      *ngIf="(bookingRequestParam == 1 || bookedParam == 1 || inactiveparam == '1' || followupleadsparam == '1' ) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined)">{{leads.Leadphase}}<span
                        *ngIf="inactiveparam == '1' || followupleadsparam == '1' && leads.Leadphase == 'Fresh'">
                        - {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------lead stage is displayed for the stages  booked,booking request,followup and inactive and done stage---------------------------- -->

                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->
                    <span
                      *ngIf="(additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.Leadphase != 'Final Negotiation' ">{{leads.Leadphase}}<span
                        *ngIf="leads.Leadphase == 'Fresh'">- {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->

                    <!-- ----------------------------lead stage which are in junk ,where are showing the laststage---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase == 'Junk' && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && leads.laststage != 'Final Negotiation' && usvParam != 1 && normalcallparam != 1">{{leads.laststage}}</span>
                    <span
                      *ngIf="leads.Leadphase == 'Junk' && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && (junkvisitsParam == 1 || junkleadsParam == '1') && leads.laststage != 'Final Negotiation' && usvParam != 1 && normalcallparam != 1">{{leads.laststage}}</span>
                    <!-- ----------------------------lead stage which are in junk ,where are showing the laststage---------------------------- -->

                    <!-- ----------------------------Status which is in done is shown for USV stage---------------------------- -->
                    <span *ngIf="usvParam == '1'">USV Done &nbsp;<span><i class="fa fa-long-arrow-alt-right"></i>
                      </span><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>
                    <!-- ----------------------------Status which is in done is shown for RSV stage---------------------------- -->
                    <span
                      *ngIf="rsvParam == '1' && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined)">RSV
                      Done &nbsp;<span><i class="fa fa-long-arrow-alt-right"></i> </span><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>
                    <!-- ----------------------------Status which is in done is shown for FN stage---------------------------- -->
                    <span
                      *ngIf="fnParam == '1' && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined)">FN
                      Done &nbsp;<span><i class="fa fa-long-arrow-alt-right"></i> </span><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>

                    <!-- ----------------------------lead stage which are in Final Negotiation is shown as FN---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase == 'Final Negotiation' && junkvisitsParam != 1  && junkleadsParam != '1' && leads.Leadphase != leads.laststage && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined)  && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{"FN"}}</span>
                    <span
                      *ngIf="leads.Leadphase == 'Final Negotiation' && junkvisitsParam != 1 && junkleadsParam != 1 && stagestatusval != '3' && stagestatusval != '' && stagestatusval != undefined && fnParam == 1 ">{{"FN"}}</span>
                    <span
                      *ngIf="leads.laststage == 'Final Negotiation' && (junkvisitsParam == 1 || junkleadsParam == '1')">{{"FN"}}</span>
                    <span
                      *ngIf="leads.laststage == 'Final Negotiation' && (additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched') && junkvisitsParam != 1 && junkleadsParam != 1 && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{"FN"}}</span>
                    <!-- ----------------------------lead stage which are in Final Negotiation is shown as FN---------------------------- -->

                    <!-- ----------------------------lead stage USV fix shown for NC---------------------------- -->
                    <span *ngIf="normalcallparam == 1">USV Fix</span>
                    <!-- ----------------------------lead stage USV fix shown for NC---------------------------- -->

                    <!-- ----------------------------To show leadstatus for sv,NC,RSV,FN with lead status not equal to done---------------------------- -->
                    <span
                      *ngIf="leads.stagestatus == '1' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && usvParam != 1 && normalcallparam != 1">{{'Fix'}}</span>
                    <span
                      *ngIf="leads.stagestatus == '2' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && usvParam != 1 && normalcallparam != 1">{{'Refix'}}</span>
                    <span
                      *ngIf="leads.stagestatus == '3' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != ''  && stagestatusval != undefined && usvParam != 1 && normalcallparam != 1">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for sv,NC,RSV,FN with lead status not equal to done---------------------------- -->

                    <!-- ----------------------------To show leadstatus for sv,NC,RSV,FN with lead status equal to done  and showing followup if leadphase and laststage is equal---------------------------- -->
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined)&& leads.Leadphase != leads.laststage && leads.stagestatus == '1' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{'Fix'}}</span>
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.Leadphase != leads.laststage && leads.stagestatus == '2' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{'Refix'}}</span>
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.Leadphase != leads.laststage && leads.stagestatus == '3' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for sv,NC,RSV,FN with lead status equal to done  and showing followup if leadphase and laststage is equal---------------------------- -->

                    <!-- ----------------------------To show leadstatus for junk lead status equal to done---------------------------- -->
                    <span
                      *ngIf="(junkvisitsParam == 1 || junkleadsParam == 1) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '1'">{{'Fix'}}</span>
                    <span
                      *ngIf="(junkvisitsParam == 1 || junkleadsParam == 1)  && (stagestatusval == 3  || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '2'">{{'Refix'}}</span>
                    <span
                      *ngIf="(junkvisitsParam == 1 || junkleadsParam == 1) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '3'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for junk lead status equal to done---------------------------- -->

                    <!-- ----------------------------To show leadstatus for usv done status and showing followup if leadphase and laststage is equal---------------------------- -->
                    <span
                      *ngIf="(usvParam) == 1  && leads.Leadphase != leads.laststage && leads.stagestatus == '1' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Fix'}}</span>
                    <span
                      *ngIf="(usvParam) == 1  && leads.Leadphase != leads.laststage && leads.stagestatus == '2' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Refix'}}</span>
                    <span
                      *ngIf="(usvParam) == 1  && leads.Leadphase != leads.laststage && leads.stagestatus == '3' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for usv done status and showing followup if leadphase and laststage is equal---------------------------- -->

                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->
                    <span
                      *ngIf="(additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.Leadphase == 'Final Negotiation' && leads.laststage != 'Final Negotiation'">{{"FN"}}</span>
                    <span
                      *ngIf="(additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '1' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Fix'}}</span>
                    <span
                      *ngIf="(additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '2' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Refix'}}</span>
                    <span
                      *ngIf="(additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '3' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->

                  </td>
                  <!-- ----------------------------lead stage---------------------------- -->
                  <!-- ----------------------------Executive Name---------------------------- -->
                  <td *ngIf="role_type == '1'">
                    {{leads.Executivename}}</td>
                  <!-- ----------------------------Executive Name---------------------------- -->

                  <!-- ----------------------------Assigned-DATE---------------------------- -->
                  <td
                    [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '#666666' }">
                    {{leads.assigneddate | date:
                    'dd-MMM-yyyy'}}
                    <div>{{leads.assigneddate | date: 'hh:mm a'}}</div>
                  </td>
                  <!-- ----------------------------Assigned-DATE---------------------------- -->

                  <!-- ----------------------------Next Action Date as Next Followup Date---------------------------- -->
                  <td *ngIf=" followupleadsparam == '1'">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy' }}
                    <div>{{leads.nextactiontime}}</div>
                  </td>
                  <!-- ----------------------------Next Action Date as Next Followup Date---------------------------- -->

                  <!------------------------------Next Action Date for FixedVisits lists------------------------------>
                  <!-- <td *ngIf="fixedvisitsparam == '1'"
                    [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (usvParam || rsvParam || fnParam)) ? 'white' : '#666666' }">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.nextactiontime}}</div>
                  </td> -->
                  <!------------------------------Next Action Date for FixedVisits lists------------------------------>

                  <!------------------------------Next Action Date for NC,USV,RSV,FN------------------------------>
                  <td
                    *ngIf="((normalcallparam == 1) || ( additionalParam == 'Active' || additionalParam == 'Assigned')) || ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined) && (usvParam ==1 || rsvParam ==1 || fnParam == 1))">
                    <span
                      *ngIf="(leads.nextactiondate != '' && leads.nextactiondate != undefined && leads.nextactiondate != null) && (leads.nextactiontime!= '' && leads.nextactiontime!= undefined && leads.nextactiontime != null)">
                      {{leads.nextactiondate | date: 'dd-MMM-yyyy' }}
                      <div>{{leads.nextactiontime}}</div>
                    </span>
                    <span
                      *ngIf="(leads.nextactiondate == '' || leads.nextactiondate == undefined || leads.nextactiondate == null) || (leads.nextactiontime == '' || leads.nextactiontime == undefined || leads.nextactiontime == null)">
                      <div style="font-weight: 600;" class="text-center">Moved To</div>
                      <div style="font-weight: 600;" class="text-center">Junk</div>
                    </span>
                  </td>
                  <!------------------------------Next Action Date for NC,USV,RSV,FN------------------------------>

                  <!------------------------------Visited Date for NC,USV,RSV,FN------------------------------>
                  <td
                    *ngIf="(((usvParam || rsvParam || fnParam || junkvisitsParam) == '1') || (additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits' || additionalParam == 'Assigned'))  ">
                    {{leads.visiteddate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.visitedtime}}</div>
                  </td>
                  <!------------------------------Visited Date for NC,USV,RSV,FN------------------------------>

                  <!------------------------------Next Action Date for Overdues List------------------------------>
                  <!-- <td *ngIf=" overduesparam == '1'"
                    [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (usvParam || rsvParam || fnParam)) ? 'white' : '#666666' }">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.nextactiontime}}</div>
                  </td> -->
                  <!------------------------------Next Action Date for Overdues List------------------------------>

                  <!------------------------------Last Updated Date for Inactive List------------------------------>
                  <td *ngIf="inactiveparam == '1'">
                    {{leads.lastupdated | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.lastupdated | date: 'hh:mm a'}}</div>
                  </td>
                  <!------------------------------Last Updated Date for Inactive List------------------------------>

                  <!------------------------------Latest Remarks Fetch Section------------------------------>
                  <td class="remarksection"
                    *ngIf="!(freshleadsparam == '1' || pendingleadsparam == '1' || leaddetails)">
                    <div style="overflow: hidden;white-space: normal;">
                      <div style="word-wrap: break-word;">{{leads.visitremarks}}</div>
                      <hr class="m-0" *ngIf="leads.visitremarks && leads.manualremarks">
                      {{leads.manualremarks}}
                    </div>
                  </td>
                  <!------------------------------Latest Remarks Fetch Section------------------------------>

                  <!-- ----------------------------view section with Reject and approve only for booking request and view only data for booked---------------------------- -->
                  <td *ngIf="bookingRequestParam == 1 || bookedParam == 1" class="text-center"
                    style="width: 5%;cursor: pointer;">
                    <span
                      (click)="verifyrequest(leads.LeadID,leads.suggestedprop[0].propid,leads.ExecId,leads.suggestedprop[0].name)"
                      data-toggle="modal" data-target="#dealcloserequest"><i class="fa fa-eye"></i> </span>
                  </td>
                  <!-- ----------------------------view section with Reject and approve only for booking request and view only data for booked---------------------------- -->
                </tr>
              </tbody>
            </table>
            <!-- All Visits Related Data listing table For Executive View-->

          </div>
          <!-- All Visits Related Data Detail opening in Side to Side Section For Executive View-->
          <!-- <div *ngIf="rmleaddetails" class="crm-auto-scrollrm padding-medium panel-content panel-2"
            style="height: 650px;">
            <div class="container-header-height">
              <div class="row-medium">
                <div class="card no-border conv-container">
                  <div class="card-header" style="background: white; padding: 10px 16px; box-shadow: none !important;">
                    <div class="pro-header flex-row">
                      <div class="profile-image cursor-pointer"><img class="center-vertical"
                          src="assets/img/contact_card_avatar.png" /></div>
                      <div class="profile-image margin-left-20px cursor-pointer flex-max-content">
                        <div class="contact-header-profile">
                          <span class="text-row rolo-text-header">
                            {{selecteduser.customer_name}}&nbsp;

                            <span class="text-color-secondary font-secondary crm-naming "> </span>
                          </span>
                          <div class="flex-row">
                            <span class="float-left ">

                              <span class="tag-flag flag-type-tag margin-right-3px font-secondary ">iconest5</span>
                            </span>
                            <span class="float-left ">

                              <span class="tag-flag flag-type-tag margin-right-3px font-secondary ">sobha_windsor</span>
                            </span>

                          </div>

                        </div>
                      </div>
                      <div class="margin-left-10px float-right">
                        <img (click)="closehistory();"
                          class="float-left center-vertical margin-left-10px cursor-pointer conv-icon"
                          src="assets/img/close.png" />
                      </div>

                    </div>
                  </div>

                  <div class="card-body no-padding flex-center conv-content-area">

                    <hr class="recent-line " />
                    <div class="card no-border">
                      <div class="card-body no-padding">


                        <div class="">
                          <div class="recent-list flex-row">
                            <div class="not-col-1">
                              <img class="margin-top-10 float-left margin-right-20px activity-icon bg_color_new_contact"
                                src="assets/img/contact_white.png" />
                            </div>
                            <div class="flex-max-content recent-list-content position-relative">

                              <span class="text-row text-color-secondary ">
                                <span class="crm-naming"><b>You</b></span> assigned Lead to

                                <span class="crm-naming "><b>{{selecteduser.customer_assign_name}}</b></span>

                              </span>

                              <span class="text-row text-color-secondary font-third ">Mar 27th 2023 Mon, 5:40 PM</span>

                              <div class="conv-edit-view center-vertical " style="margin-right: 35px;"></div>

                            </div>
                          </div>
                        </div>

                        <div class="" *ngFor="let leadhistory of leadtrack;let i = index">
                          <div class="recent-list flex-row">
                            <div class="not-col-1">
                              <img class="margin-top-10 float-left margin-right-20px activity-icon bg_color_new_contact"
                                src="assets/img/contact_white.png" />
                            </div>
                            <div class="flex-max-content recent-list-content position-relative">

                              <span class="text-row text-color-secondary">
                                <span class="crm-naming"><b>{{leadhistory.executivename}}</b></span> Update the Lead to
                                <span class="crm-naming "><b>{{leadhistory.status}}</b></span>
                              </span>
                              <span class="text-row text-color-secondary">
                                <span class="crm-naming"><b>Note - </b></span>
                                {{leadhistory.Remarks}}
                              </span>

                              <span class="text-row text-color-secondary font-third ">{{leadhistory.Saveddate | date:
                                'fullDate'}} at {{leadhistory.Saveddate | date: 'mediumTime'}}</span>

                              <div class="conv-edit-view center-vertical " style="margin-right: 35px;"></div>

                            </div>
                          </div>
                        </div>

                      </div>
                    </div>

                  </div>
                  <div class="card-footer row no-margin">

                    <div class="input-conv float-left margin-left-10px flex-center">
                      <textarea
                        class="note-input input-group-text align-left-fixed col-lg-12 input-group-lg margin-top-3px ng-pristine ng-valid ng-touched"
                        placeholder="Type a note" rows="1"></textarea>

                    </div>
                    <div class="attachments float-left">
                      <div class="file-chooser">
                        <img src="assets/img/attach.png" /><input class="" id="txtFileUpload" name="File Upload"
                          style="z-index: -1;" type="file" />
                      </div>

                    </div>
                    <div class="send-conv float-left margin-left-10px">
                      <button appdebounceclick=""
                        class="btn btn-primary btn-default-width float-left flex-row-center fresh-chat-z-index">
                        <span class="">Add</span>

                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div> -->
          <!-- All Visits Related Data Detail opening in Side to Side Section For Executive View-->
        </div>

        <div class="crm-sub-container padding-medium-full">
          <div class="panel-1 crm-auto-scrollrm panel-content">
            <!-- All Visits Related Data listing table For ADMIN View-->
            <table *ngIf="tookactiontable" class="content_table_main table table-striped table-bordered" infinite-scroll
              [fromRoot]="true" [scrollWindow]="false" [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
              (scrolled)="loadMoreassignedleads()" [infiniteScrollContainer]="'.CSassigned_table'">
              <thead>
                <!-- ----------------------------This tr is not in use---------------------------- -->
                <tr class="header" *ngIf="leaddetails">
                  <th stylw="width:10%">#</th>
                  <th>Name </th>
                  <th style="width: 25%;" class="remarksection" *ngIf="!(freshleadsparam || pendingleadsparam) == '1'">
                    Latest Remark</th>
                </tr>
                <!-- ----------------------------This tr is not in use---------------------------- -->

                <tr class="header" *ngIf="!leaddetails">
                  <!-- ----------------------------sl no---------------------------- -->
                  <th style="width: 3%;">#</th>
                  <!-- ----------------------------Lead received with recivedFrom and recivedTo date filter---------------------------- -->
                  <th [ngStyle]="{'width': pendingleadsparam == '1' ?'165px' : ''}">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Lead Date</span>
                      <span class="leadreceiveddrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="leadReceivedDropdown" data-toggle="dropdown"
                            (click)="showdateRange()" aria-haspopup="true" aria-expanded="false"
                            style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="leadReceivedDropdown"
                            style="cursor:pointer;padding: 0rem;;display: none;">
                            <div style="position: relative;display: none;">
                              <input #datepicker1 class="form-control" id="todate" name="options" type="text"
                                bsDaterangepicker autocomplete="off" [maxDate]="currentdateforcompare"
                                placeholder="Select Date" [(bsValue)]="leadReceivedDateRange"
                                (bsValueChange)="onLeadReceivedDateRangeSelected($event)" required>
                              <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                                <i class="fas fa-calendar-alt"></i>
                              </span>
                            </div>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------Name---------------------------- -->
                  <th>Name </th>
                  <!-- ----------------------------Lead status with filter---------------------------- -->
                  <th *ngIf="pendingleadsparam != 1 && followupleadsparam != 1 && normalcallparam != 1">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Visit Type</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="assignLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="assignLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('All')">All</a>
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('Assigned')">Assigned</a>
                            <a class="dropdown-item dropDownCursor" (click)="leadStatus('Direct Visits')">Direct
                              Visits</a>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------source with filter--------------------------- -->
                  <th *ngIf="roleid == '1'">
                    <div class="d-flex justify-content-between">
                      <span>Source</span>
                      <div>
                        <button class="btn btn-warning" type="button" id="bookingLeadDropdown_source"
                          data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                          style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu propertyBasedFilter" aria-labelledby="bookingLeadDropdown_source"
                          style="cursor:pointer; max-height: 250px;max-width: auto;overflow-y: auto;overflow-x: hidden;">
                          <!-- Filter Search  input -->
                          <div class="dropdown-search-container"><input type="text" class="form-control sourcesearch"
                              placeholder="Search..." [(ngModel)]="searchTerm_source" (input)="filtersource()"
                              style="margin-bottom: 2px;"></div>
                          <!-- Dropdown items with checkboxes -->
                          <div class="source_list_checkbox">
                            <div *ngFor="let sourcelist of sourceList">
                              <label class="dropdown-item dropDownCursor mb-1">
                                <input type="checkbox" class="mr-2 loopcheckbox hidesourcecheckbox"
                                  id="hidesourcecheckboxid" value="{{sourcelist?.source}}" name='sourceFilter'
                                  (change)="onCheckboxChangesource()">
                                {{ sourcelist.source }}
                              </label>
                            </div>
                          </div>

                        </div>
                      </div>
                    </div>
                  </th>
                  <!-- ----------------------------property with filter---------------------------- -->
                  <th>
                    <div class="d-flex justify-content-between">
                      <span>Property</span>
                      <div>
                        <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu propertyBasedFilter" aria-labelledby="bookingLeadDropdown"
                          style="cursor:pointer; max-height: 250px;max-width: 250px;overflow-y: auto;">
                          <!-- Filter Search  input -->
                          <div class="dropdown-search-container"><input type="text" class="form-control propsearch"
                              placeholder="Search..." [(ngModel)]="searchTerm" (input)="filterProjects()"
                              style="margin-bottom: 2px;"></div>
                          <!-- Dropdown items with checkboxes -->
                          <div *ngIf="mandateprojects?.length">
                            <div *ngFor="let project of mandateprojects">
                              <label class="dropdown-item dropDownCursor mb-1">
                                <!-- <input type="checkbox" class="mr-2 loopcheckbox hidepropcheckbox"
                                  id="hidepropcheckboxid" value="{{project?.property_idfk}}" name='propFilter'
                                  (change)="onCheckboxChange()"> -->
                                <span (click)="onCheckboxChange(project)"> {{ project.property_info_name }}</span>
                              </label>
                            </div>
                          </div>
                          <div *ngIf="!mandateprojects?.length" class="text-center" style="color: #666666;">
                            <h4>No Properties Found</h4>
                          </div>
                        </div>
                      </div>
                    </div>
                  </th>
                  <!-- ----------------------------stage with filter---------------------------- -->
                  <th *ngIf="!(pendingleadsparam) == '1'">
                    <span
                      *ngIf="(bookedParam || normalcallparam || usvParam || junkleadsParam || additionalParam == 'Active' || additionalParam == 'Touched' )  == '1' && ( rsvParam || fnParam || followupleadsparam || bookingRequestParam || junkvisitsParam) != 1">Stage</span>
                    <div class="d-flex justify-content-between align-items-center" *ngIf=" (rsvParam || fnParam) == 1 ">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"
                              *ngIf="((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('1')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">Fixed</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('2')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">ReFixed</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('3')"
                              *ngIf="usvParam != 1 && ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined))">Done</a>
                            <!-- <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('4')"
                              *ngIf="(stagestatusval == 3 || usvParam == 1)">Followup</a>
                            <a class="dropdown-item dropDownCursor" (click)="stagestatuschange('5')"
                              *ngIf="stagestatusval == 3 || usvParam == 1">Junk</a> -->
                          </div>
                        </div>
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center"
                      *ngIf="(junkvisitsParam == 1 || additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'ActiveVisits')&& (normalcallparam || usvParam || rsvParam ||fnParam || followupleadsparam || inactiveparam || bookingRequestParam || bookedParam || junkleadsParam) != 1">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu" aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <!-- <div class="dropdown-item dropDownCursor " (click)="junkstatuschange('Fresh','')">Fresh
                            </div> -->
                            <div class="dropdown-item dropDownCursor ">
                              <div class="d-flex justify-content-between" (click)="junkstatuschange('USV','')">
                                <span>USV</span><i class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','1')">Fix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','2')">Refix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('USV','3')">Done</a>
                              </div>
                            </div>
                            <div class="dropdown-item dropDownCursor">
                              <div class="d-flex justify-content-between" (click)="junkstatuschange('RSV','')">
                                <span>RSV</span><i class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','1')">Fix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','2')">Refix</a>
                                <a class="submenu-item" (click)="junkStageStatusChange('RSV','3')">Done</a>
                              </div>
                            </div>
                            <div class="dropdown-item dropDownCursor">
                              <div class="d-flex justify-content-between"
                                (click)="junkstatuschange('Final Negotiation','')"><span>FN</span><i
                                  class="fa fa-angle-right"
                                  *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'"></i>
                              </div>
                              <div class="submenu"
                                *ngIf="additionalParam != 'AllVisits' && additionalParam != 'ActiveVisits'">
                                <a class="submenu-item" (click)="junkStageStatusChange('Final Negotiation','1')">Fix</a>
                                <a class="submenu-item"
                                  (click)="junkStageStatusChange('Final Negotiation','2')">Refix</a>
                                <a class="submenu-item"
                                  (click)="junkStageStatusChange('Final Negotiation','3')">Done</a>
                              </div>
                            </div>
                          </div>
                        </div>
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <!-- <div>
                        <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('USV')">USV</a>
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('RSV')">RSV</a>
                          <a class="dropdown-item dropDownCursor" (click)="junkstatuschange('Final Negotiation')">FN</a>
                        </div>
                      </div> -->
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center"
                      *ngIf=" (followupleadsparam || inactiveparam) == 1 ">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu categoryBasedFilter" aria-labelledby="category  Dropdown"
                            style="cursor:pointer; max-height: 250px;max-width: 250px;overflow-y: auto;">
                            <!-- Filter Search  input -->
                            <div class="dropdown-search-container"><input type="text"
                                class="form-control categorysearch" placeholder="Search..."
                                [(ngModel)]="searchTerm_stagecategory" (input)="filterStageCategory()"
                                style="margin-bottom: 2px;"></div>
                            <!-- Dropdown items with checkboxes -->
                            <div *ngIf="followctgFilter?.length">
                              <div class="exec_list_checkbox">
                                <div *ngFor="let category of followctgFilter">
                                  <label class="dropdown-item dropDownCursor mb-1"
                                    (click)="onCheckboxstageCategoryChange(category)">
                                    <!-- <input type="checkbox" class="mr-2 loopcheckbox hideStageCategorycheckbox" id="hideStageCategorycheckboxid"
                                   value="{{category?.followup_section_IDPK}}" name='categoryStageFilter' (change)="onCheckboxstageCategoryChange()"> -->
                                    {{ category.followup_categories }}
                                  </label>
                                </div>
                              </div>


                            </div>
                            <div *ngIf="!followctgFilter?.length" class="text-center" style="color: #666666;">
                              <h4>No Categories Found</h4>
                            </div>
                          </div>
                        </div>
                      </span>
                    </div>

                    <div class="d-flex justify-content-between align-items-center" *ngIf="bookingRequestParam == 1 ">
                      <span>Stage</span>
                      <span class="leadstatusdrop d-flex">
                        <!-- <span style="font-size: 14px;">{{selectedBookingLeadStatus}}</span> -->
                        <div>
                          <button class="btn btn-warning" type="button" id="bookingLeadDropdown" data-toggle="dropdown"
                            aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="bookingLeadDropdown" style="cursor:pointer;">
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('All')">All</a>
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('Rejected')">Rejected</a>
                            <a class="dropdown-item dropDownCursor" (click)="bookingLeadStatus('Pending')">Pending</a>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------Assigned to(RM)---------------------------- -->
                  <th>
                    <div class="d-flex justify-content-between">
                      <span>Assignees</span>
                      <div>
                        <button class="btn btn-warning" type="button" id="executiveDropdown" data-toggle="dropdown"
                          aria-haspopup="true" aria-expanded="false" style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu executiveBasedFilter" aria-labelledby="executiveDropdown"
                          style="cursor:pointer; max-height: 250px;max-width: 250px;overflow-y: auto;">
                          <!-- Filter Search  input -->
                          <div class="dropdown-search-container"><input type="text" class="form-control executivesearch"
                              placeholder="Search..." [(ngModel)]="searchTerm_executive" (input)="filterExecutive()"
                              style="margin-bottom: 2px;"></div>
                          <!-- Dropdown items with checkboxes -->
                          <div *ngIf="mandateExecutivesFilter?.length">
                            <div *ngFor="let exec of mandateExecutivesFilter">
                              <label class="dropdown-item dropDownCursor mb-1">
                                <input type="checkbox" class="mr-2 loopcheckbox hideExecutivecheckbox"
                                  id="hideExecutivecheckboxid" value="{{exec?.id}}" name='executiveFilter'
                                  (change)="onCheckboxExecutiveChange()">
                                {{ exec.name }}
                              </label>
                            </div>
                          </div>
                          <div *ngIf="!mandateExecutivesFilter?.length" class="text-center" style="color: #666666;">
                            <h4>No Executives Found</h4>
                          </div>
                        </div>
                      </div>
                    </div>
                  </th>
                  <!-- ----------------------------ASSIGNED ON for pending---------------------------- -->
                  <th> 
                    <div class="d-flex justify-content-between align-items-center">
                    <span>Assigned On</span>
                    <span class="leadstatusdrop d-flex">
                      <div>
                        <button class="btn btn-warning" type="button" id="datefilterDropdown" data-toggle="dropdown"
                          (click)="showdateRange4()" aria-haspopup="true" aria-expanded="false"
                          style="padding: 0px 5px !important;">
                          <i class="fas fa-filter" style="color: white;"></i>
                        </button>
                        <div class="dropdown-menu " aria-labelledby="datefilterDropdown"
                          style="cursor:pointer;padding: 0rem;display: none;">
                          <div style="position: relative;display: none;">
                            <input #datepicker4 class="form-control" id="fromdate" name="options" type="text"
                              bsDaterangepicker autocomplete="off" placeholder="Select Date"
                              [(bsValue)]="assignedOnDateRange"
                              (bsValueChange)="onAssignedOnDateRangeSelected($event)" required>
                            <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                              <i class="fas fa-calendar-alt"></i>
                            </span>
                          </div>
                        </div>
                      </div>
                    </span>
                    </div>
                </th>
                  <!-- ----------------------------NEXT FOLLOWUP for general followups---------------------------- -->
                  <th *ngIf="followupleadsparam == '1'">Next Followup</th>
                  <!-- ----------------------------Not in use ---------------------------- -->
                  <th *ngIf="fixedvisitsparam == '1'">Visits Fixed</th>
                  <!-- ----------------------------Next action for NC,USV,RSV,FN with from and to date filter---------------------------- -->
                  <th
                    *ngIf="((normalcallparam == 1) || ( additionalParam == 'Active' || additionalParam == 'Assigned')) || ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined) && (usvParam ==1 || rsvParam ==1 || fnParam == 1))"
                    style="width: 10%;">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Next Action </span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <button class="btn btn-warning" type="button" id="datefilterDropdown" data-toggle="dropdown"
                            (click)="showdateRange2()" aria-haspopup="true" aria-expanded="false"
                            style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu " aria-labelledby="datefilterDropdown"
                            style="cursor:pointer;padding: 0rem;display: none;">
                            <div style="position: relative;display: none;">
                              <input #datepicker2 class="form-control" id="fromdate" name="options" type="text"
                                bsDaterangepicker autocomplete="off" placeholder="Select Date"
                                [(bsValue)]="nextActionDateRange"
                                (bsValueChange)="onNextActionDateRangeSelected($event)" required>
                              <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                                <i class="fas fa-calendar-alt"></i>
                              </span>
                            </div>
                          </div>
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------USV,RSV,FN with visitedfrom and visitedto date filter---------------------------- -->
                  <th
                    *ngIf="(((usvParam  || rsvParam || fnParam || junkvisitsParam) == '1') || (additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'  || additionalParam == 'Assigned'))">
                    <div class="d-flex justify-content-between align-items-center">
                      <span>Visited On</span>
                      <span class="leadstatusdrop d-flex">
                        <div>
                          <div id="reportrange" class="cursor-pointer">
                            <i class="fas fa-filter" style="color: white;"></i>&nbsp;
                            <!-- <span ></span>  -->
                            <!-- <i class="fa fa-caret-down"></i> -->
                          </div>
                          <!-- <button class="btn btn-warning visitedDatefilter" type="button" id="visitedDatefilterDropdown"
                            data-toggle="dropdown" (click)="showdateRange3()" aria-haspopup="true" aria-expanded="false"
                            style="padding: 0px 5px !important;">
                            <i class="fas fa-filter" style="color: white;"></i>
                          </button>
                          <div class="dropdown-menu visitedDfilter" aria-labelledby="visitedDatefilterDropdown"
                            style="cursor:pointer;padding: 0rem;display: none;">
                            <div style="position: relative;display: none;">
                              <input #datepicker3 class="form-control" id="visiteddate" name="options" type="text"
                                bsDaterangepicker autocomplete="off" [maxDate]="currentdateforcompare"
                                placeholder="Select Date" [(bsValue)]="visitedDateRange"
                                (bsValueChange)="onVisitedDateRangeSelected($event)" required>
                              <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
                                <i class="fas fa-calendar-alt"></i>
                              </span>
                            </div>
                          </div> -->
                        </div>
                      </span>
                    </div>
                  </th>
                  <!-- ----------------------------Not in use - overdued on action for overdue section---------------------------- -->
                  <th *ngIf="overduesparam == '1'">Overdued On</th>
                  <!-- ----------------------------Last Updated for inactive---------------------------- -->
                  <th *ngIf="inactiveparam == '1'">Last Update</th>
                  <!-- ----------------------------Lastest remarks---------------------------- -->
                  <th class="remarksection" *ngIf="!(pendingleadsparam == '1' || leaddetails)" style="width: 20%;">
                    Latest Remarks</th>
                  <!-- ----------------------------view section with Reject and approve only for booking request and view only data for booked---------------------------- -->
                  <th *ngIf="bookingRequestParam == 1 || bookedParam == 1"></th>
                </tr>
              </thead>
              <tbody *ngIf="callerleads?.length" class="enquiry_table_body">
                <tr *ngFor="let leads of callerleads; let i = index">
                  <!-- ----------------------------Sl.no---------------------------- -->
                  <td style="text-align: center;">
                    {{i+1}}</td>
                  <!-- ----------------------------Sl.no---------------------------- -->

                  <!-- ----------------------------Lead details and we are not using this td---------------------------- -->
                  <td *ngIf="leaddetails"><a class="btn_style cursor-pointer"
                      routerLink="/mandate-customers/{{leads.LeadID}}/{{leads?.ExecId}}/{{'0'}}/{{'mandate'}}/{{leads.propertyid}}">{{leads.CustomerName}}
                      - {{leads.number}}</a>
                    <div>
                      <span class="lead-flag suggested float-left">{{leads.source}}</span>
                      <span class="lead-flag suggested float-left">{{leads.propertyname}}</span>
                      <span class="lead-flag suggested float-left"
                        *ngIf="!(freshleadsparam == '1' || pendingleadsparam == '1')">{{leads.Leadphase}}</span>
                      <span class="lead-flag suggested float-left">{{leads.Executivename}}</span>
                      <span class="lastvisit float-right" *ngIf="leads.assigneddate != null">
                        Assigned On <span class="onlydatefetch">{{leads.assigneddate | date: 'dd-MMM-yyyy hh:mm a'}}
                        </span>
                      </span>
                    </div>
                  </td>
                  <!-- ----------------------------Lead details and we are not using this td---------------------------- -->

                  <!-- ----------------------------Lead Received---------------------------- -->
                  <td>
                    <!-- ----------------------------Lead Received date if its assigned for the same person again---------------------------- -->
                    <span
                      *ngIf="(leads?.leadDate | date: 'dd-MMM-yyyy') !== (leads?.latestDateTime | date: 'dd-MMM-yyyy')">
                      {{leads?.latestDateTime | date: 'dd-MMM-yyyy'}}
                      <span *ngIf="leads?.latestDateTime">,{{ leads?.latestDateTime | date: 'hh:mm a'}}</span>
                    </span>
                    <!-- ----------------------------Lead Received date if its assigned for the same person again---------------------------- -->
                    <hr class="m-0"
                      *ngIf="(leads?.leadDate | date: 'dd-MMM-yyyy') !== (leads?.latestDateTime | date: 'dd-MMM-yyyy')">
                    <!-- ----------------------------Lead Received date if its assigned for the first time---------------------------- -->
                    <span style="font-size: 12px; font-weight: 300;display: block;" class="mt-1"
                      *ngIf="(leads?.leadDate | date: 'dd-MMM-yyyy') !== (leads?.latestDateTime | date: 'dd-MMM-yyyy')">First
                      Received</span>
                    <span style="font-size: 12px;font-weight: 300"
                      *ngIf="(leads?.leadDate | date: 'dd-MMM-yyyy') !== (leads?.latestDateTime | date: 'dd-MMM-yyyy')">{{leads.leadDate
                      | date: 'dd-MMM-yyyy'}} <span *ngIf="leads.leadTime">,{{ leads.leadTime}}</span> </span>
                    <span
                      *ngIf="((leads?.leadDate | date: 'dd-MMM-yyyy') == (leads?.latestDateTime | date: 'dd-MMM-yyyy')) || leads?.latestDateTime == null">{{leads.leadDate
                      | date: 'dd-MMM-yyyy'}} <span *ngIf="leads.leadTime">,{{ leads.leadTime}}</span></span>
                    <!-- ----------------------------Lead Received date if its assigned for the first time---------------------------- -->
                  </td>
                  <!-- ----------------------------Lead Received---------------------------- -->

                  <!-- ----------------------------Customer name and number---------------------------- -->
                  <td *ngIf="!leaddetails"
                    [ngStyle]="{'width': pendingleadsparam == '1' ?'280px' : '','color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : ' ' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                    <a class="btn_style cursor-pointer"
                      routerLink="/mandate-customers/{{leads.LeadID}}/{{leads?.ExecId}}/{{'0'}}/{{'mandate'}}/{{leads.propertyid}}">
                      <div class="statuscard"
                        [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                        {{leads.CustomerName}}<span class="statusbatch"
                          *ngIf="(leads.assigneddate | date:'yyyy-MM-dd') == todaysdateforcompare && pendingleadsparam == '1'">{{leads.Leadphase}}
                          <i class="fa fa-sync-alt"></i> </span></div>
                      <div
                        [ngStyle]="{'color': (todaysdateforcompare > leads?.nextactiondate && ( normalcallparam || usvParam || rsvParam || fnParam)) ? 'red' : '' , 'opacity' : (todaysdateforcompare > leads?.nextactiondate && (normalcallparam || usvParam || rsvParam || fnParam)) ? '75%' :''}">
                        {{leads.number}}</div>
                    </a>
                  </td>
                  <!-- ----------------------------Customer name and number---------------------------- -->

                  <!-- ----------------------------Lead Assigned or Direct visit---------------------------- -->
                  <td *ngIf="pendingleadsparam != 1 && followupleadsparam != 1 && normalcallparam != 1">
                    <span *ngIf="leads?.Leadidentifier == 0">Assigned</span>
                    <span *ngIf="leads?.Leadidentifier == 1">Direct</span>
                  </td>
                  <!-- ----------------------------Lead Assigned or Direct visit---------------------------- -->

                  <!-- ----------------------------Lead source---------------------------- -->
                  <td *ngIf="!leaddetails && roleid == '1'">
                    {{leads.source == 'GR - Microsite' ? 'GR - campaign' : leads.source}}</td>
                  <!-- ----------------------------Lead source---------------------------- -->

                  <!-- ----------------------------Lead properties---------------------------- -->
                  <td *ngIf="!leaddetails">
                    {{leads.propertyname}}</td>
                  <!-- ----------------------------Lead properties---------------------------- -->

                  <!-- ----------------------------Lead stage---------------------------- -->
                  <td *ngIf="!(pendingleadsparam == '1' || leaddetails)">

                    <!-- ----------------------------lead stage is displayed for the stages not equal to usv and lead phase not equal to junk and Final negotiation and not equal to done stage---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase != 'Final Negotiation' && leads.Leadphase != 'Junk' && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && usvParam != 1 && normalcallparam != 1 && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{leads.Leadphase}}<span
                        *ngIf="inactiveparam == '1' || followupleadsparam == '1' && leads.Leadphase == 'Fresh'">
                        - {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------lead stage is displayed for the stages not equal to usv and lead phase not equal to junk and Final negotiation and not equal to done stage---------------------------- -->

                    <!-- ----------------------------lead stage is displayed for the stages  booked,booking request,followup and inactive and done stage---------------------------- -->
                    <span
                      *ngIf="(bookingRequestParam == 1 || bookedParam == 1 || inactiveparam == '1' || followupleadsparam == '1' ) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined)">{{leads.Leadphase}}<span
                        *ngIf="inactiveparam == '1' || followupleadsparam == '1' && leads.Leadphase == 'Fresh'">
                        - {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------lead stage is displayed for the stages  booked,booking request,followup and inactive and done stage---------------------------- -->

                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->
                    <span
                      *ngIf="(additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.Leadphase != 'Final Negotiation' ">{{leads.Leadphase}}
                      <span *ngIf="leads.Leadphase == 'Fresh'">- {{leads.followup_categories}}</span></span>
                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->

                    <!-- ----------------------------lead stage which are in junk ,where are showing the laststage---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase == 'Junk' && stagestatusval != 3 && stagestatusval != ''  && stagestatusval != undefined && leads.laststage != 'Final Negotiation' && usvParam != 1 && normalcallparam != 1">{{leads.laststage}}</span>
                    <span
                      *ngIf="leads.Leadphase == 'Junk' && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && (junkvisitsParam == 1 || junkleadsParam == 1) && leads.laststage != 'Final Negotiation' && usvParam != 1 && normalcallparam != 1">{{leads.laststage}}</span>
                    <!-- ----------------------------lead stage which are in junk ,where are showing the laststage---------------------------- -->

                    <!-- ----------------------------Status which is in done is shown for USV stage---------------------------- -->
                    <span *ngIf="usvParam == '1'">USV Done &nbsp;<div style="position: relative;left: 20px;"><i
                          class="fa fa-long-arrow-alt-down"></i> </div><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>
                    <!-- ----------------------------Status which is in done is shown for RSV stage---------------------------- -->
                    <span
                      *ngIf="rsvParam == '1' && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined)">RSV
                      Done &nbsp;<div style="position: relative;left: 20px;"><i class="fa fa-long-arrow-alt-down"></i>
                      </div><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>
                    <!-- ----------------------------Status which is in done is shown for FN stage---------------------------- -->
                    <span
                      *ngIf="fnParam == '1' && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined)">FN
                      Done &nbsp;<div style="position: relative;left: 20px;"><i class="fa fa-long-arrow-alt-down "></i>
                      </div><span
                        *ngIf="leads.Leadphase != leads.laststage && leads.Leadphase != 'Final Negotiation'">{{leads.Leadphase}}</span>
                      <span
                        *ngIf="leads.Leadphase == 'Final Negotiation' && junkvisitsParam != 1 && junkleadsParam != 1 && leads.Leadphase != 'Final Negotiation'">{{"FN"}}</span>
                      <span *ngIf="leads.Leadphase == leads.laststage">{{'Followup'}}</span></span>

                    <!-- ----------------------------lead stage which are in Final Negotiation is shown as FN---------------------------- -->
                    <span
                      *ngIf="leads.Leadphase == 'Final Negotiation' && junkvisitsParam != 1 && junkleadsParam != 1 && leads.Leadphase != leads.laststage && (stagestatusval == '3' || stagestatusval == '' || stagestatusval == undefined) && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched'">{{"FN"}}</span>
                    <span
                      *ngIf="leads.Leadphase == 'Final Negotiation' && junkvisitsParam != 1 && junkleadsParam != 1 && stagestatusval != '3' && stagestatusval != '' && stagestatusval != undefined && fnParam == 1 ">{{"FN"}}</span>
                    <span
                      *ngIf="leads.laststage == 'Final Negotiation' && (junkvisitsParam == 1 || junkleadsParam == 1)">{{"FN"}}</span>
                    <span
                      *ngIf="leads.laststage == 'Final Negotiation' && (additionalParam == 'AllVisits' || additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && junkvisitsParam != 1 && junkleadsParam != 1 && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{"FN"}}</span>
                    <!-- ----------------------------lead stage which are in Final Negotiation is shown as FN---------------------------- -->

                    <!-- ----------------------------lead stage USV fix shown for NC---------------------------- -->
                    <span *ngIf="normalcallparam == 1">USV Fix</span>
                    <!-- ----------------------------lead stage USV fix shown for NC---------------------------- -->

                    <!-- ----------------------------lead stage Leadphase2 for all visits shown---------------------------- -->
                    <span *ngIf="additionalParam == 'AllVisits'">{{leads.Leadphase2}} Done</span>
                    <!-- ----------------------------lead stage Leadphase2 for all visits shown---------------------------- -->

                    <!-- ----------------------------To show leadstatus for NC,RSV,FN with lead status not equal to done---------------------------- -->
                    <span
                      *ngIf="leads.stagestatus == '1' && usvParam != '1' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && normalcallparam != 1 && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{'Fix'}}</span>
                    <span
                      *ngIf="leads.stagestatus == '2' && usvParam != '1' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && normalcallparam != 1 && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{'Refix'}}</span>
                    <span
                      *ngIf="leads.stagestatus == '3' && usvParam != '1' && inactiveparam != '1' && bookingRequestParam != 1 && bookedParam != 1 && stagestatusval != 3 && stagestatusval != '' && stagestatusval != undefined && normalcallparam != 1 && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for NC,RSV,FN with lead status not equal to done---------------------------- -->

                    <!-- ----------------------------To show leadstatus for NC,RSV,FN with lead status equal to done  and showing followup if leadphase and laststage is equal---------------------------- -->
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.Leadphase != leads.laststage && leads.stagestatus == '1' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' ">{{'Fix'}}</span>
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.Leadphase != leads.laststage && leads.stagestatus == '2' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{'Refix'}}</span>
                    <span
                      *ngIf="(rsvParam || fnParam) == 1 && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.Leadphase != leads.laststage && leads.stagestatus == '3' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'DCRR' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for NC,RSV,FN with lead status equal to done  and showing followup if leadphase and laststage is equal---------------------------- -->

                    <!-- ----------------------------To show leadstatus for junk lead status equal to done---------------------------- -->
                    <span
                      *ngIf="(junkvisitsParam == 1 ) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '1'">{{'Fix'}}</span>
                    <span
                      *ngIf="(junkvisitsParam == 1 )  && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '2'">{{'Refix'}}</span>
                    <span
                      *ngIf="(junkvisitsParam == 1 ) && (stagestatusval == 3 || stagestatusval == '' || stagestatusval == undefined) && leads.laststage != 'Junk' && leads.stagestatus == '3'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for junk lead status equal to done---------------------------- -->

                    <!-- ----------------------------To show leadstatus for usv done status and showing followup if leadphase and laststage is equal---------------------------- -->
                    <span
                      *ngIf="(usvParam) == 1 &&  leads.Leadphase != leads.laststage && leads.stagestatus == '1' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR' && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{'Fix'}}</span>
                    <span
                      *ngIf="(usvParam) == 1 &&  leads.Leadphase != leads.laststage && leads.stagestatus == '2' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR' && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' &&  additionalParam != 'ActiveVisits'">{{'Refix'}}</span>
                    <span
                      *ngIf="(usvParam) == 1 &&  leads.Leadphase != leads.laststage && leads.stagestatus == '3' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR' && additionalParam != 'AllVisits' && additionalParam != 'Assigned' && additionalParam != 'Active' && additionalParam != 'Touched' && additionalParam != 'ActiveVisits'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for usv done status and showing followup if leadphase and laststage is equal---------------------------- -->


                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->
                    <span
                      *ngIf="(additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.Leadphase == 'Final Negotiation' && leads.laststage != 'Final Negotiation'">{{"FN"}}</span>
                    <span
                      *ngIf="(additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '1' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Fix'}}</span>
                    <span
                      *ngIf="( additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '2' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Refix'}}</span>
                    <span
                      *ngIf="(additionalParam == 'Assigned' || additionalParam == 'Active' || additionalParam == 'Touched' || additionalParam == 'ActiveVisits') && leads.stagestatus == '3' && leads.Leadphase != 'Deal Closing Requested' && leads.Leadphase != 'Deal Closed' && leads.Leadphase != 'Junk' && leads.Leadphase != 'Closing Request Rejected' && leads.Leadphase != 'DCRR'">{{'Done'}}</span>
                    <!-- ----------------------------To show leadstatus for allvisits---------------------------- -->
                  </td>
                  <!-- ----------------------------Lead stage---------------------------- -->

                  <!-- ----------------------------Assigned-Executive-Name---------------------------- -->
                  <td *ngIf="!leaddetails">
                    {{leads.Executivename}}</td>
                  <!-- ----------------------------Assigned-Executive-Name---------------------------- -->

                  <!-- ----------------------------Assigned-DATE---------------------------- -->
                  <td *ngIf="!leaddetails">
                    {{leads.assigneddate |
                    date: 'dd-MMM-yyyy'}}
                    <div>{{leads.assigneddate | date: 'hh:mm a'}}</div>
                  </td>
                  <!-- ----------------------------Assigned-DATE---------------------------- -->

                  <!-- ----------------------------Next Action Date as Next Followup Date---------------------------- -->
                  <td *ngIf="!leaddetails && followupleadsparam == '1'">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy' }}
                    <div>{{leads.nextactiontime}}</div>
                  </td>
                  <!-- ----------------------------Next Action Date as Next Followup Date---------------------------- -->

                  <!-- <td *ngIf="!leaddetails && fixedvisitsparam == '1'">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.nextactiontime}}</div>
                  </td> -->

                  <!------------------------------Next Action Date for NC,USV,SV,RSV,FN------------------------------>
                  <td
                    *ngIf="((normalcallparam == 1) || (additionalParam == 'Active' || additionalParam == 'Assigned')) || ((visitedFrom == '' || visitedFrom == undefined) && (visitedTo == '' || visitedTo == undefined) && (usvParam ==1 || rsvParam ==1 || fnParam == 1))">
                    <span
                      *ngIf="(leads.nextactiondate != '' && leads.nextactiondate != undefined && leads.nextactiondate != null) && (leads.nextactiontime!= '' && leads.nextactiontime!= undefined && leads.nextactiontime != null)">
                      {{leads.nextactiondate | date: 'dd-MMM-yyyy' }}
                      <div>{{leads.nextactiontime}}</div>
                    </span>
                    <span
                      *ngIf="(leads.nextactiondate == '' || leads.nextactiondate == undefined || leads.nextactiondate == null) || (leads.nextactiontime == '' || leads.nextactiontime == undefined || leads.nextactiontime == null)">
                      <div style="font-weight: 600;" class="text-center">Moved To</div>
                      <div style="font-weight: 600;" class="text-center">Junk</div>
                    </span>
                  </td>
                  <!------------------------------Next Action Date for NC,USV,RSV,FN------------------------------>

                  <!------------------------------Visited Date for NC,USV,RSV,FN------------------------------>
                  <td
                    *ngIf="!leaddetails && (((usvParam  || rsvParam || fnParam || junkvisitsParam) == '1') || (additionalParam == 'AllVisits' || additionalParam == 'ActiveVisits'  || additionalParam == 'Assigned'))  ">
                    {{leads.visiteddate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.visitedtime}}</div>
                  </td>
                  <!------------------------------Visited Date for NC,USV,RSV,FN------------------------------>

                  <!------------------------------Next Action Date for Overdues List------------------------------>
                  <td *ngIf="!leaddetails && overduesparam == '1'">
                    {{leads.nextactiondate | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.nextactiontime}}</div>
                  </td>
                  <!------------------------------Next Action Date for Overdues List------------------------------>

                  <!------------------------------Last Updated Date for Inactive List------------------------------>
                  <td *ngIf="!leaddetails && inactiveparam == '1'">
                    {{leads.lastupdated | date: 'dd-MMM-yyyy'}}
                    <div>{{leads.lastupdated | date: 'hh:mm a'}}</div>
                  </td>
                  <!------------------------------Last Updated Date for Inactive List------------------------------>

                  <!------------------------------Latest Remarks Fetch Section------------------------------>
                  <td class="remarksection"
                    *ngIf="!(freshleadsparam == '1' || pendingleadsparam == '1' || leaddetails)">
                    <!-- <div>{{leads.visitremarks}}
                    <hr class="m-0" *ngIf="leads.visitremarks && leads.manualremarks"> {{leads.manualremarks}} -->
                    <div style="overflow: hidden;white-space: normal;">
                      <div style="word-wrap: break-word;"
                        *ngIf="leads.Leadphase2 != 'USV' && leads.Leadphase2 != 'RSV'">{{leads.visitremarks}}</div>
                      <div style="word-wrap: break-word;" *ngIf="leads.Leadphase2 == 'USV'">{{leads.usvvisitremarks}}
                      </div>
                      <div style="word-wrap: break-word;" *ngIf="leads.Leadphase2 == 'RSV'">{{leads.rsvvisitremarks}}
                      </div>
                      <hr class="m-0" *ngIf="leads.visitremarks && leads.manualremarks">
                      {{leads.manualremarks}}
                    </div>
                  </td>
                  <!------------------------------Latest Remarks Fetch Section------------------------------>

                  <!-- ----------------------------view section with Reject and approve only for booking request and view only data for booked---------------------------- -->
                  <td *ngIf="bookingRequestParam == 1  || bookedParam == 1" class="text-center"
                    style="width: 5%;cursor: pointer;">
                    <span
                      (click)="verifyrequest(leads.LeadID,leads.suggestedprop[0].propid,leads.ExecId,leads.suggestedprop[0].name,leads.Leadphase)"
                      data-toggle="modal" data-target="#dealcloserequest"><i class="fa fa-eye"></i> </span>
                  </td>
                  <!-- ----------------------------view section with Reject and approve only for booking request and view only data for booked---------------------------- -->
                </tr>
              </tbody>
            </table>
            <!-- All Visits Related Data listing table For ADMIN View-->
          </div>

          <!-- All Visits Related Data Detail opening in Side to Side Section For ADMIN View-->
          <!-- <div *ngIf="leaddetails" class="crm-auto-scroll padding-medium panel-content panel-2 table-container" style="height: 650px;" >
                    <div class="container-header-height">
                      <div class="row-medium">
                              <div  class="card no-border conv-container">
                                  <div  class="card-header" style="background: rgb(255, 255, 255); padding: 10px 16px; box-shadow: none !important;">
                                      <div  class="pro-header flex-row">
                                          <div  class="profile-image cursor-pointer" style="display: flex; flex-direction: column;gap: 2rem;align-items: center;justify-content: center;">
                                            <img  class="center-vertical" src="assets/img/contact_card_avatar.png" />
                                            <div class="rolo-text-header" ><a class="btn_style" routerLink="/mandate-customers/{{selecteduser[0].customer_IDPK}}/{{'0'}}/{{'mandate'}}/{{leads.propertyid}}">{{selecteduser[0]?.customer_name                                            }}
                                            </a></div>
                                          </div>
                                          <div  class="profile-image margin-left-20px  cursor-pointer flex-max-content" style="margin-top:10px">
                                              <div  class="contact-header-profile" style="display: flex; flex-direction: row; gap:3rem;">
                                                <div>
                                                  <label class="mbo-0 fs-12">Number</label> 
                                                  <span  class="text-row rolo-text-header">
                                                    {{selecteduser[0]?.customer_number}}
                                                    <span  class="text-color-secondary font-secondary crm-naming "> </span>
                                                </span>
                                                </div>
                                                <div style="flex-direction: column;" *ngIf="!(freshleadsparam == '1' || pendingleadsparam == '1')">
                                                  <label class="mbo-0 fs-12">Stage</label> 
                                                  <span  class="text-row rolo-text-header">
                                                    {{selecteduser[0].leadstage}}
                                                    <span  class="text-color-secondary font-secondary crm-naming "> </span>
                                                </span>
                                              </div>

                                              <div style="flex-direction: column;">
                                                <label class="mbo-0 fs-12">Assigned Date</label>
                                                <span  class="text-row rolo-text-header">
                                                  {{selecteduser[0].walkintime | date: 'dd-MMM-yyyy'}} at {{selecteduser[0].walkintime | date: 'hh:mm a'}}
                                                  <span  class="text-color-secondary font-secondary crm-naming "> </span>
                                              </span>
                                            </div>                                        
                                              </div>
                                              <div  class="pt-2" style="flex-direction: column;">
                                                <label class="mbo-0 fs-12">Visited Property </label>
                                                <div style="display: flex; flex-direction: row;">
                                                  <div *ngFor="let pro of selecteduser" >
                                                  <span  class="text-row rolo-text-header">
                                                   {{pro.suggestedprop[0].name}} 
                                                    <span  class="text-color-secondary font-secondary crm-naming "> </span>
                                                </span> 
                                                </div>
                                                </div>                                                 
                                            </div>
                                          </div>
                                          <div  class="margin-left-10px float-right">                                             
                                              <img (click)="closehistory();" class="float-left center-vertical-close margin-left-10px cursor-pointer conv-icon" src="assets/img/close.png" />
                                          </div>
                                          
                                      </div>
                                  </div>
                                  
                                  <div  class="card-body no-padding flex-center conv-content-area">
                                      
                                      <hr  class="recent-line " />
                                      <div  class="card no-border">
                                          <div  class="card-body no-padding">                                      
                                              <div  class=""> </div>
                                              <div class="leadsRemarks">
                                                <div   *ngFor="let leadhistory of leadtrack;let i = index"> 
                                                  <div  class="recent-list flex-row">
                                                      <div  class="not-col-1">
                                                          <img  class="margin-top-10 float-left margin-right-20px activity-icon bg_color_new_contact" src="assets/img/contact_white.png" />
                                                      </div>
                                                      <div  class="flex-max-content recent-list-content position-relative">
                                                          
                                                          <span class="text-row text-color-secondary">
                                                              <span  class="crm-naming"><b >{{leadhistory.executivename}}</b></span> Update the Lead to
                                                              <span  class="crm-naming "><b >{{leadhistory.status}}</b></span>
                                                          </span>
                                                          <span class="text-row text-color-secondary">
                                                            <span  class="crm-naming"><b >Note - </b></span>
                                                            {{leadhistory.autoremarks}}
                                                          </span>
                                                          
                                                          <span  class="text-row text-color-secondary font-third ">{{leadhistory.Saveddate | date: 'dd-MMM-yyyy'}} at {{leadhistory.Saveddate | date: 'hh:mm a'}}</span>
                                                          
                                                          <div  class="conv-edit-view center-vertical " style="margin-right: 35px;"></div> 
                                                      </div>
                                                  </div>
                                              </div>
                                              <div  class="recent-list flex-row">
                                                <div  class="not-col-1">
                                                    <img  class="margin-top-10 float-left margin-right-20px activity-icon bg_color_new_contact" src="assets/img/contact_white.png" />
                                                </div>
                                                <div  class="flex-max-content recent-list-content position-relative" >
                                                    
                                                    <span  class="text-row text-color-secondary" >
                                                        <span  class="crm-naming"><b >You</b></span> assigned Lead to
                                                        
                                                        <span  class="crm-naming "><b >{{callerleads[0].Executivename}}</b></span>
                                                        
                                                    </span>
                                                    
                                                    <span  class="text-row text-color-secondary font-third ">{{callerleads[0].assigneddate | date: 'dd-MMM-yyyy hh:mm a'}} </span>
                                                    
                                                    <div  class="conv-edit-view center-vertical " style="margin-right: 35px;"></div>
                                                    
                                                </div>
                                            </div>
                                            </div>
                                              
                                          </div>
                                      </div>
                                      
                                  </div>
                                  <div  class="card-footer row no-margin">
                                      
                                      <div  class="input-conv float-left margin-left-10px flex-center">
                                          <textarea  class="note-input input-group-text align-left-fixed col-lg-12 input-group-lg margin-top-3px ng-pristine ng-valid ng-touched" placeholder="Type a note" rows="1"></textarea>
                                          
                                      </div>
                                      <div  class="attachments float-left">
                                          <div  class="file-chooser">
                                              <img  src="assets/img/attach.png" /><input  class="" id="txtFileUpload" name="File Upload" style="z-index: -1;" type="file" />
                                          </div>
                                          
                                      </div>
                                      <div  class="send-conv float-left margin-left-10px">
                                          <button  appdebounceclick="" class="btn btn-primary btn-default-width float-left flex-row-center fresh-chat-z-index">
                                              <span  class="">Add</span>
                                              
                                          </button>
                                      </div>
                                  </div>
                              </div>
                          </div>
                  </div>
                  </div>  -->
          <!-- All Visits Related Data Detail opening in Side to Side Section For ADMIN View-->
        </div>

        <!-- Followup Sections Table -->
        <div class="text-center lead_norecord" *ngIf="! callerleads?.length">
          No Leads Found.....
        </div>
      </div>
    </div>


    <!-- ---------------------------- this is the table content for re-assign---------------------------- -->
    <!-- <div class="table-container " [hidden]="!isReAssign">
      <div class="row px-3">
        <div class="col-3">
          <label class="font-bold">Select Lead Date</label>
          <div style="position: relative;">
            <input class="form-control" id="reassigntodate" name="options" type="text" bsDaterangepicker
              autocomplete="off" placeholder="Select Date" [(bsValue)]="dateRange"
              (bsValueChange)="onDateRangeSelected($event)" required>
            <span style="position: absolute; top: 25%;right: 10px; opacity: 75%;color: #0B7AB2;">
              <i class="fas fa-calendar-alt"></i>
            </span>
          </div>
        </div>
        <div class=" col-3 ">
          <label class="font-bold">Execuitve Team</label>
          <select class="form-control ui dropdown dashboard_dropdown mr-3" id="exec_designation"
            (change)="getreassignexecutives($event)">
            <option style="display:none" value="" selected>Select Team</option>
            <option value="1">Direct Team</option>
            <option value="2">Inhouse Team</option>
          </select>
        </div>
        <div class=" col-3 ">
          <label class="font-bold d-flex justify-content-between"><span>Executives</span>
            <span>
              <div class="d-flex justify-content-center" style="gap: 0.5rem">
                <p class="m-0">Active</p>
                <div class="custom-control custom-switch">
                  <input type="checkbox" class="custom-control-input" id="customSwitch1" checked
                    (change)="checkActive($event)">
                  <label class="custom-control-label m-0" for="customSwitch1"></label>
                </div>
              </div>
            </span>
          </label>
          <p-multiSelect id="exec_dropdown" [options]="mandateExecutives" [(ngModel)]="selectedEXEC" [filter]="true"
            optionLabel="name" #customersupport="ngModel" name="customersupport" defaultLabel="Select Executives"
            (onChange)="executiveSelect($event)"></p-multiSelect>
        </div>
        <div class="col-3 ">
          <label class="font-bold">Status</label>
          <select id="statuslist_dropdown" class="form-control ui fluid dropdown" (change)="statusSelect($event)">
            <option style="display:none" value="" selected>Select Status</option>
            <option value="untouched">Untouched</option>
            <option value="inactive">Inactive</option>
            <option value="followups">Followups</option>
            <option value="USV">USV</option>
            <option value="RSV">RSV</option>
            <option value="FN">FN</option>
          </select>
        </div>
        <div class="col-3 " [hidden]="selectedStatus != 'followups'">
          <label>Select SubStatus :</label>
          <select id="followup_dropdown" class="form-control ui fluid dropdown" (change)="subStatusSelection($event)">
            <option style="display:none" value="" selected>Select FollowStatus</option>
            <option *ngFor="let section of followupsections" value="{{section.followup_section_IDPK}}">
              {{section.followup_categories}}</option>
          </select>
        </div>

        <div class=" col-3 ">
          <label class="font-bold">Leads Count</label>
          <select id="leadcount_dropdown" class="form-control ui fluid dropdown" (change)="selectcounts($event)">
            <option style="display:none" value="" selected>Select Lead Count</option>
            <option value="Manual">Manual Select</option>
            <option value="5">5</option>
            <option value="10">10</option>
            <option value="20">20</option>
            <option value="30">30</option>
            <option value="50">50</option>
            <option value="100">100</option>
          </select>
        </div>
        <div class="col-3 ">
          <label>Search by Name or Number</label>
          <input type="text" class="form-control" [(ngModel)]="filterLeads" placeholder="Search with Customer Name"
            style="height: 2.6rem;" />
        </div>
      </div>
      <div class="assign_table1 pt-3">
        <div class="crm-sub-container padding-medium-full">
          <div class="panel-1 crm-auto-scroll panel-content">
            <table id="start2" class="content_table_main table table-striped table-bordered" infinite-scroll
              [fromRoot]="true" [scrollWindow]="false" [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
              [infiniteScrollContainer]="'.assign_table1'" (scrolled)="loadMoreReassignedleads()">
              <thead>
                <tr class="header">
                  <th style="width: 10%;"> Sl.No</th>
                  <th style="width: 165px !important;">Lead Recieved</th>
                  <th style="width: 300px;">Name</th>
                  <th>Source</th>
                  <th>Property</th>
                  <th>Assigned To</th>
                  <th>Assigned On</th>
                </tr>
              </thead>
              <tbody class="enquiry_table_body">
                <input type="hidden" id="selectedleads" [(ngModel)]="selectedAssignedleads" #assignedleads="ngModel"
                  name="assignedleads" required>
                <tr *ngFor="let assign of  reassignleadsinfo | NameFilter:filterLeads, let i = index">
                  <td style="text-align: center;">
                    <div>
                      <input type="checkbox" class="mr-4 loopcheckbox hidecheckbox" id="hidecheckboxid"
                        value="{{assign?.LeadID}}" name='programming' (change)="getselectedleads()"
                        style="display: none;">
                      <label>{{i+1}}</label>
                    </div>
                  </td>
                  <td>
                    <span
                      *ngIf="(assign?.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">
                      {{assign?.latestDateTime | date: 'dd-MMM-yyyy'}},
                      {{ assign?.latestDateTime | date: 'hh:mm a'}}
                    </span>
                    <hr class="m-0"
                      *ngIf="(assign?.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">
                    <span style="font-size: 12px; font-weight: 300;display: block;" class="mt-1"
                      *ngIf="(assign?.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">First
                      Received</span>
                    <span style="font-size: 12px;font-weight: 300"
                      *ngIf="(assign?.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">{{assign?.leadDate
                      | date: 'dd-MMM-yyyy'}}, {{ assign?.leadTime}} </span>
                    <span
                      *ngIf="((assign?.leadDate | date: 'dd-MMM-yyyy') == (assign?.latestDateTime | date: 'dd-MMM-yyyy')) || assign?.latestDateTime == null">{{assign?.leadDate
                      | date: 'dd-MMM-yyyy'}}, {{ assign?.leadTime}} </span>
                  </td>
                  <td>
                    <div class="statuscard">{{assign.CustomerName}} <span class="statusbatch">{{assign.Leadphase}} <i
                          class="fa fa-sync-alt"></i> </span></div>
                  </td>
                  <td>{{assign.source}}</td>
                  <td>{{assign.propertyname}}</td>
                  <td>{{assign.Executivename}}</td>
                  <td>{{assign.assigneddate | date: 'dd-MMM-yyyy'}}</td>
                </tr>
              </tbody>
            </table>

          </div>
        </div>
        <div class="text-center lead_norecord" *ngIf="!reassignleadsinfo?.length">
          No Leads Found.....
        </div>
      </div>
    </div> -->
  </div>

  <div hidden class="more_filter_maindiv p-3">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" (click)="close()"><span aria-hidden="true">&times;</span><span
            class="sr-only">Close</span></button>
      </div>
      <div class="modal-body">
        <div class="row datfiltermain">
          <!-- Project Based & Executive based Filter For Admin Account -->
          <!-- <div *ngIf="tookactiontable" class="col-6">
              <label>Select Project :</label>
               <select id="project_dropdown" class="form-control ui dropdown dashboard_dropdown mr-3"
               (change)="propchange($event)">
               <option value="">Select Project</option>
               <option value="all">All</option>
               <option *ngFor="let projects of mandateprojects" value="{{projects.property_idfk}}"
                 [selected]="projects.property_idfk === propertyid">{{projects.property_info_name}}</option>
             </select>
            </div> -->

          <!-- <div *ngIf="tookactiontable" class="col-6">
            <label>Select Source :</label>
            <select id="source_dropdown" class="form-control ui dropdown" (change)="sourcechange($event)">
              <option value="">Select Source</option>
              <option value="all">All</option>
              <option *ngFor="let sourcelist of sourceList" value="{{sourcelist.source}}"
                [selected]="sourcelist.source === source">{{sourcelist.source}}</option>
            </select>
          </div> -->

          <!-- <div *ngIf="tookactiontable" class="col-6">
            <label>Select Team :</label>
            <select id="project_dropdown5" class="form-control ui dropdown dashboard_dropdown mr-3"
              (change)="teamchange($event)">
              <option value="">Select Team</option>
              <option value="all">All</option>
              <option value="1" [selected]="'1' === team">Direct Team</option>
              <option value="2" [selected]="'2' === team">Inhouse Team</option>
            </select>
          </div> -->

          <!-- <div *ngIf="tookactiontable" class="col-6" [ngStyle]="{'padding-top': directteamfound ? '0.5rem' : '0.5rem'}">
            <label>Select Executive :</label>
            <select id="rm_dropdown" class="form-control ui dropdown dashboard_dropdown" (change)="rmchange($event)">
              <option value="">Select Executive</option>
              <option value="all">All</option>
              <option *ngFor="let executives of mandateexecutives" value="{{executives.id}}"
                [selected]="executives.id === execid">{{executives.name}}</option>
            </select>
          </div> -->

          <div class="col-6 pt-2" *ngIf="tookactiontable">
            <label>Select Priority Type :</label>
            <select id="project_dropdown3" class="form-control ui dropdown dashboard_dropdown mr-3"
              (change)="prioritychange($event)">
              <option value="">Select Priority</option>
              <option value="hot" [selected]="'hot' === priorityType">HOT</option>
              <option value="warm" [selected]="'warm' === priorityType">WARM</option>
              <option value="cold" [selected]="'cold' === priorityType">COLD</option>
            </select>
          </div>
          <!-- Project Based & Executive based Filter For Admin Account -->

          <!-- <div class="mt-3 col-12" *ngIf="junkParam == '1' ">
            <label>Select Lead Stage :</label>
            <div class="wrapper">
              <input type="radio" name="select" value="USV" id="option-1" [checked]="stagevalue == 'USV'"
                (click)="statuschange($event)">
              <input type="radio" name="select" value="RSV" id="option-2" [checked]="stagevalue == 'RSV'"
                (click)="statuschange($event)">
              <input type="radio" name="select" value="Final Negotiation" [checked]="stagevalue == 'Final Negotiation'"
                id="option-3" (click)="statuschange($event)">
              <label for="option-1" class="option option-1">
                <span>USV</span>
              </label>
              <label for="option-2" class="option option-2">
                <span>RSV</span>
              </label>
              <label for="option-3" class="option option-3">
                <span>Final Negotiation</span>
              </label>
            </div>
            <input type="hidden" id="budgetselect">
          </div> -->

          <!-- <div *ngIf="junkParam == '1'" class="mt-3 col-12">
            <label>Select Stage Status :</label>
            <div class="wrapper">
              <input type="radio" name="select1" value="1" id="option-4" [checked]="stagestatusval == '1'"
                (click)="stagestatuschange('1')">
              <input type="radio" name="select1" value="2" id="option-5" [checked]="stagestatusval == '2'"
                (click)="stagestatuschange('2')">
              <input type="radio" name="select1" value="3" id="option-6" [checked]="stagestatusval == '3'"
                (click)="stagestatuschange('3')">
              <label for="option-4" class="option option-4">
                <span>Fixed</span>
              </label>
              <label for="option-5" class="option option-5">
                <span>Refixed</span>
              </label>
              <label for="option-6" class="option option-6">
                <span>Done</span>
              </label>
            </div>
            <input type="hidden" id="budgetselect">
          </div> -->

          <!-- <div class="mt-3 col-12">
            <div class="date_filter">
              <label>Filter by Visit Date:</label>
              <input autocomplete="off" class="form-control" id="fromdate" type="text" bsDatepicker
                [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }" placeholder="Select From Date" required>
            </div>
            <div class="date_to_label">
              <label>To</label>
            </div>
            <div class="date_to_date">
              <input autocomplete="off" class="form-control" id="selectedtodate" type="text" bsDatepicker
                [bsConfig]="{ dateInputFormat: 'YYYY-MM-DD' }" placeholder="Select To Date" required >
            </div>
          </div> -->

        </div>
      </div>
      <div class="modal-footer">
        <a class="apply_btn" (click)="filterhere()">Apply</a>
      </div>
    </div>
  </div>

</div>

<!-- MAIN-CONTENTS -->

<!-- ---------------------------- reassign table---------------------------- -->
<div class="modal fade" id="assign_lead" tabindex="-1" role="dialog" aria-labelledby="defModalHead" aria-hidden="true">
  <div class="modal-dialog assignlead_modal">
    <div class="modal-content enquiry_modal_body" id="assign_leads">
      <div class="modal-header">
        <h4 class="col-10 m-0">Total Re-Assign Leads : {{reassignleadsCount}}</h4>
        <div class="d-flex" style="gap: 0.2rem">
          <label>Random Assign</label>
          <div class="custom-control custom-switch">
            <input type="checkbox" class="custom-control-input" id="customSwitch5" (change)="checkRandom($event)"
              [disabled]="maxSelectedLabels == 1">
            <label class="custom-control-label" for="customSwitch5"></label>
          </div>
        </div>
        <button type="button" class="close" id="closereassignmodal" data-dismiss="modal"><span
            aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
      </div>
      <div class="modal-body">
        <div class="new_enquiry_form col-xs-12">
          <form class="form-inline" name="form" novalidate>

            <div class="form-group col-3 input_cmn_div">
              <label class="font-bold">Assign Team</label>
              <select id="team_dropdown" class="form-control ui dropdown dashboard_dropdown mr-1"
                (change)="reassignTeam($event)">
                <option value="">Select Team</option>
                <option value="retail" [selected]="'retail' === team">Retail Team</option>
                <option value="mandate" [selected]="'mandate' === team">Mandate Team</option>
              </select>
            </div>

            <div class="form-group col-3 input_cmn_div" [hidden]="selectedTeamType != 'mandate'">
              <label class="font-bold">Select Property</label>
              <select id="property_dropdown" class="form-control ui dropdown dashboard_dropdown mr-3"
                (change)="reassignPropChange($event)">
                <option value="" selected>Select Project</option>
                <option *ngFor="let projects of mandateprojects" value="{{projects.property_idfk}}"
                  [selected]="projects.property_idfk == selectedMandateProp">
                  {{projects.property_info_name}}</option>
              </select>
            </div>

            <div class="form-group col-3 input_cmn_div">
              <label class="font-bold">Leads Count</label>
              <select id="leadcount_dropdown" class="form-control ui fluid dropdown" (change)="selectcounts($event)">
                <option style="display:none" value="" selected>Select Lead Count</option>
                <option value="Manual">Manual Select</option>
                <option value="5">5</option>
                <option value="10">10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="50">50</option>
                <option value="60">60</option>
                <option value="70">70</option>
                <option value="80">80</option>
                <option value="90">90</option>
                <option value="100">100</option>
              </select>
            </div>

            <!-- <div class="form-group col-3 input_cmn_div" [hidden]="selectedTeamType == 'retail'">
              <label class="font-bold">Assign Executive Team</label>
              <select id="mandate_dropdown" class="form-control ui dropdown dashboard_dropdown mr-1"
                (change)="reassignExecTeam($event)">
                <option value="">Select Execuitve Team</option>
                <option value="1" [selected]="'1' === team">Direct Team</option>
                <option value="2" [selected]="'2' === team">Inhouse Team</option>
              </select>
            </div> -->

            <div class="form-group col-3 input_cmn_div" [hidden]="selectedTeamType != 'retail'">
              <label class="font-bold">Assign Executive Team</label>
              <select id="retail_dropdown" class="form-control ui dropdown dashboard_dropdown mr-1"
                (change)="reassignExecTeam($event)">
                <option value="all" selected>All</option>
                <option value="50010">Relationship Executives</option>
                <option value="50004">Customersupport Executives</option>
              </select>
            </div>

            <div class="form-group col-3 input_cmn_div" [hidden]="selectedTeamType == 'retail'">
              <label class="font-bold">Assign To</label>
              <p-multiSelect id="mandateExec_dropdown" [options]="reassignListExecutives"
                [(ngModel)]="selectedEXECUTIVES" [filter]="true" optionLabel="name" #customersupport="ngModel"
                name="customersupport" defaultLabel="Select Executives"
                (onChange)="reAssignexecutiveSelect($event)"></p-multiSelect>
            </div>

            <div class="form-group col-3 input_cmn_div" [hidden]="selectedTeamType != 'retail'"
              [ngStyle]="{'padding-top':selectedTeamType != 'retail'?'0.5rem':'0rem'}">
              <label class="font-bold">Assign To</label>
              <p-multiSelect id="retailExec_dropdown" [options]="reassignListExecutives"
                [(ngModel)]="selectedEXECUTIVES" [filter]="true" optionLabel="ExecName" #customersupport="ngModel"
                name="customersupport" defaultLabel="Select Executives"
                (onChange)="reAssignexecutiveSelect($event)"></p-multiSelect>
            </div>

            <div class="form-group col-2 input_cmn_div pt-3">
              <button type="button" class="btn btn-warning" (click)="getAssignedLeadsList()">Assign Now</button>
            </div>

            <!-- list of reassign selected leads table  -->
            <div class="assign_table1 pt-3">
              <table id="start2" class="content_table_main table table-striped table-bordered" infinite-scroll
                [fromRoot]="true" [scrollWindow]="false" [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
                [infiniteScrollContainer]="'.assign_table1'" (scrolled)="loadMoreassignedleads()">
                <tbody class="enquiry_table_body">
                  <tr *ngFor="let assign of callerleads; let i = index">
                    <td>
                      <div>
                        <input type="checkbox" class="mr-4 loopcheckbox hidecheckbox" id="hidecheckboxid"
                          value="{{assign}}" name='programming' (change)="getselectedleads()"
                          style="display: none;" [attr.data-assign]="assign | json">
                        <label>{{i+1}}</label>
                      </div>
                    </td>
                    <td>
                      <span
                        *ngIf="(assign.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">
                        {{assign?.latestDateTime | date: 'dd-MMM-yyyy'}},
                        {{ assign?.latestDateTime | date: 'hh:mm a'}}
                      </span>
                      <hr class="m-0"
                        *ngIf="(assign.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">
                      <span style="font-size: 12px; font-weight: 300;display: block;" class="mt-1"
                        *ngIf="(assign.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">First
                        Received</span>
                      <span style="font-size: 12px;font-weight: 300"
                        *ngIf="(assign.leadDate | date: 'dd-MMM-yyyy') !== (assign?.latestDateTime | date: 'dd-MMM-yyyy')">{{assign.leadDate
                        | date: 'dd-MMM-yyyy'}}, {{ assign.leadTime}} </span>
                      <span
                        *ngIf="((assign.leadDate | date: 'dd-MMM-yyyy') == (assign?.latestDateTime | date: 'dd-MMM-yyyy')) || assign?.latestDateTime == null">{{assign.leadDate
                        | date: 'dd-MMM-yyyy'}}, {{ assign.leadTime}} </span>
                    </td>
                    <td style="width: 300px;">
                      <div class="statuscard">{{assign.CustomerName}} <span class="statusbatch"
                          *ngIf="assign.Leadphase != 'Final Negotiation'">{{assign.Leadphase}} <i
                            class="fa fa-sync-alt"></i> </span><span class="statusbatch"
                          *ngIf="assign.Leadphase == 'Final Negotiation'">FN <i class="fa fa-sync-alt"></i> </span>
                      </div>
                    </td>
                    <td>{{assign.number}}</td>
                    <td>{{assign.source}}</td>
                    <td>{{assign.propertyname}}</td>
                    <!-- <td>{{assign.leadDate | date: 'dd-MMM-yyyy'}}<br/>{{assign.leadTime}}</td> -->
                    <td>{{assign.Executivename}}</td>
                    <td>{{assign.assigneddate | date: 'dd-MMM-yyyy'}}</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- ---------------------------- reassign table---------------------------- -->

<!-- ----------------------------After reassign Info table---------------------------- -->
<button type="button" data-toggle="modal" data-target="#reassigned_leads_modal" id="reassign_leads_detail"
  style="display: none;">Show
  Details</button>
<div class="modal fade" id="reassigned_leads_modal" tabindex="-1" role="dialog" aria-labelledby="defModalHead"
  aria-hidden="true">
  <div class="modal-dialog reassignlead_modal">
    <div class="modal-content enquiry_modal_body" id="reassign_leads">
      <div class="modal-header">
        <h4 class="col-10 m-0"> Re-Assign Leads</h4>
        <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span
            class="sr-only">Close</span></button>
      </div>
      <div class="modal-body">
        <div class="new_enquiry_form col-xs-12">
          <div class="assign_table1 pt-3">
            <div class="">
              <h3>ReAssigned Leads Details</h3>
            </div>
            <table class="content_table_main table table-striped table-bordered" infinite-scroll [fromRoot]="true"
              [scrollWindow]="false" [infiniteScrollDistance]="2" [infiniteScrollThrottle]="50"
              [infiniteScrollContainer]="'.assign_table1'">
              <thead>
                <tr class="header">
                  <th>#</th>
                  <th>Name</th>
                  <th>Fresh Assigned</th>
                  <th>Re-Assigned</th>
                  <th>Not Assigned</th>
                </tr>
              </thead>
              <tbody class="enquiry_table_body">
                <tr *ngFor="let reassign of reassignedResponseInfo; let i = index">
                  <td>
                    <div>
                      <label>{{i+1}}</label>
                    </div>
                  </td>
                  <td>{{reassign.execname}}</td>
                  <td>{{reassign.fresh}}</td>
                  <td>{{reassign.reassigned}}</td>
                  <td>{{reassign.exsiting}}</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- ----------------------------After reassign Info table---------------------------- -->

<div class="clearfix"></div>

<!-- ----------------------------Approve & Reject popup modal for booking and view only data for booked---------------------------- -->
<div class="modal fade" id="dealcloserequest" role="dialog">
  <div class="modal-dialog">

    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">

        <h4 class="modal-title">Closing Request for {{closepropertyname}}</h4>
        <button type="button" class="close" data-dismiss="modal">&times;</button>
      </div>
      <div class="modal-body col-12">
        <div class="row" *ngFor="let request of requestedunits">
          <div class="form-group col-4">
            <label class="mb-0">Selected Unit:</label><br />
            <span>{{request.bhk}}</span>
          </div>
          <div class="form-group col-4">
            <label class="mb-0">Unit Number:</label><br />
            <span>{{request.unit_number}}</span>
          </div>
          <div class="form-group col-4">
            <label class="mb-0">Dimension:</label><br />
            <span>{{request.dimension}}</span>
          </div>
          <div class="form-group col-4">
            <label class="mb-0">Rate Per Sqft:</label><br />
            <span>{{request.rate_per_sqft}}</span>
          </div>
          <div class="form-group col-12">
            <label>Uploaded Documents:</label>
            <div class="row">
              <div class="form-group col-6" *ngFor="let attached of request.images">

                <a *ngIf="(getExstendsion(attached.file_name) == 'jpg') || getExstendsion(attached.file_name) == 'jpeg' || getExstendsion(attached.file_name) == 'png'"
                  target="_blank"
                  href="https://superadmin-azure.right2shout.in/images/crm/closurefiles/{{attached.file_name}}">
                  <img width="100%" height="195px"
                    src="https://superadmin-azure.right2shout.in/images/crm/closurefiles/{{attached.file_name}}">
                </a>

              </div>

              <div class="form-group col-12" *ngFor="let attached of request.images">

                <a *ngIf="(getExstendsion(attached.file_name) == 'pdf')" style="color: rgba(0, 0, 0, 0.87);"
                  target="_blank"
                  href="https://superadmin-azure.right2shout.in/images/crm/closurefiles/{{attached.file_name}}">
                  <img width="7%" height="50px" src="../../../assets/images/adobe-reader.svg">
                  {{attached.file_name}}
                </a>

              </div>
            </div>
          </div>

          <div style=" width: 100%; " class="modal-footer"
            *ngIf="bookingRequestParam == 1 && roleid == 1 && leadBookingstatus != 1 && isbuttondisable == false">
            <button type="button" class="btn btn-success"
              (click)="requestapproval(request.Lead_IDFK,request.Exec_IDFK,request.property)">Approve</button>
            <button type="button" class="btn btn-danger" (click)="modaldropadd()" data-toggle="modal"
              data-target="#rejectionreason">Reject</button>
          </div>
          <div style="width: 100%;" class="modal-footer" *ngIf="isbuttondisable == true && roleid == 1 ">
            <button type="button" class="btn btn-warning">Already Rejected</button>
            <h4>(Waiting for the re-submission)</h4>
          </div>
          <div style=" width: 100%; " class="modal-footer" *ngIf="bookedParam == 1">
            <h4 style="color: #29A71A;">Admin approved the lead on {{request.closed_date}}<span
                *ngIf="request.closed_time"> ,</span> {{request.closed_time}}</h4>
          </div>
        </div>

      </div>

    </div>

  </div>
</div>
<!-- ----------------------------Approve & Reject popup modal for booking and view only data for booked---------------------------- -->

<!-- ----------------------------Rejection popup modal ---------------------------- -->
<div class="modal fade" id="rejectionreason" role="dialog">
  <div class="modal-dialog">
    <!-- Modal content-->
    <div class="modal-content">
      <div class="modal-header">
        <h4 class="modal-title">Rejection Reason for {{closepropertyname}}</h4>
        <button type="button" class="close" data-dismiss="modal" (click)="closeRejectionModal()">&times;</button>
      </div>
      <div class="modal-body col-12">
        <div *ngFor="let request of requestedunits">
          <div class="form-group">
            <label>Remarks:</label>
            <textarea style="height: 150px;" class="form-control rejectedtextarea"></textarea>
          </div>
          <div style="width: 100%;" class="modal-footer">
            <button type="button" class="btn btn-danger"
              (click)="requestrejection(request.Lead_IDFK,request.Exec_IDFK,request.property)">Submit</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- ----------------------------Rejection popup modal ---------------------------- -->

<!-- <textarea id="junkcopyleads"></textarea>s -->